"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@solana+transaction-messages@3.0.3_fastestsmallesttextencoderdecoder@1.0.22_typescript@5.9.2";
exports.ids = ["vendor-chunks/@solana+transaction-messages@3.0.3_fastestsmallesttextencoderdecoder@1.0.22_typescript@5.9.2"];
exports.modules = {

/***/ "(ssr)/../../node_modules/.pnpm/@solana+transaction-messages@3.0.3_fastestsmallesttextencoderdecoder@1.0.22_typescript@5.9.2/node_modules/@solana/transaction-messages/dist/index.node.mjs":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@solana+transaction-messages@3.0.3_fastestsmallesttextencoderdecoder@1.0.22_typescript@5.9.2/node_modules/@solana/transaction-messages/dist/index.node.mjs ***!
  \*******************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendTransactionMessageInstruction: () => (/* binding */ appendTransactionMessageInstruction),\n/* harmony export */   appendTransactionMessageInstructions: () => (/* binding */ appendTransactionMessageInstructions),\n/* harmony export */   assertIsTransactionMessageWithBlockhashLifetime: () => (/* binding */ assertIsTransactionMessageWithBlockhashLifetime),\n/* harmony export */   assertIsTransactionMessageWithDurableNonceLifetime: () => (/* binding */ assertIsTransactionMessageWithDurableNonceLifetime),\n/* harmony export */   compileTransactionMessage: () => (/* binding */ compileTransactionMessage),\n/* harmony export */   compressTransactionMessageUsingAddressLookupTables: () => (/* binding */ compressTransactionMessageUsingAddressLookupTables),\n/* harmony export */   createTransactionMessage: () => (/* binding */ createTransactionMessage),\n/* harmony export */   decompileTransactionMessage: () => (/* binding */ decompileTransactionMessage),\n/* harmony export */   getCompiledTransactionMessageCodec: () => (/* binding */ getCompiledTransactionMessageCodec),\n/* harmony export */   getCompiledTransactionMessageDecoder: () => (/* binding */ getCompiledTransactionMessageDecoder),\n/* harmony export */   getCompiledTransactionMessageEncoder: () => (/* binding */ getCompiledTransactionMessageEncoder),\n/* harmony export */   getTransactionVersionCodec: () => (/* binding */ getTransactionVersionCodec),\n/* harmony export */   getTransactionVersionDecoder: () => (/* binding */ getTransactionVersionDecoder),\n/* harmony export */   getTransactionVersionEncoder: () => (/* binding */ getTransactionVersionEncoder),\n/* harmony export */   isAdvanceNonceAccountInstruction: () => (/* binding */ isAdvanceNonceAccountInstruction),\n/* harmony export */   isTransactionMessageWithBlockhashLifetime: () => (/* binding */ isTransactionMessageWithBlockhashLifetime),\n/* harmony export */   isTransactionMessageWithDurableNonceLifetime: () => (/* binding */ isTransactionMessageWithDurableNonceLifetime),\n/* harmony export */   prependTransactionMessageInstruction: () => (/* binding */ prependTransactionMessageInstruction),\n/* harmony export */   prependTransactionMessageInstructions: () => (/* binding */ prependTransactionMessageInstructions),\n/* harmony export */   setTransactionMessageFeePayer: () => (/* binding */ setTransactionMessageFeePayer),\n/* harmony export */   setTransactionMessageLifetimeUsingBlockhash: () => (/* binding */ setTransactionMessageLifetimeUsingBlockhash),\n/* harmony export */   setTransactionMessageLifetimeUsingDurableNonce: () => (/* binding */ setTransactionMessageLifetimeUsingDurableNonce)\n/* harmony export */ });\n/* harmony import */ var _solana_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @solana/errors */ \"(ssr)/../../node_modules/.pnpm/@solana+errors@3.0.3_typescript@5.9.2/node_modules/@solana/errors/dist/index.node.mjs\");\n/* harmony import */ var _solana_rpc_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @solana/rpc-types */ \"(ssr)/../../node_modules/.pnpm/@solana+rpc-types@3.0.3_fastestsmallesttextencoderdecoder@1.0.22_typescript@5.9.2/node_modules/@solana/rpc-types/dist/index.node.mjs\");\n/* harmony import */ var _solana_addresses__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @solana/addresses */ \"(ssr)/../../node_modules/.pnpm/@solana+addresses@3.0.3_fastestsmallesttextencoderdecoder@1.0.22_typescript@5.9.2/node_modules/@solana/addresses/dist/index.node.mjs\");\n/* harmony import */ var _solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @solana/codecs-core */ \"(ssr)/../../node_modules/.pnpm/@solana+codecs-core@3.0.3_typescript@5.9.2/node_modules/@solana/codecs-core/dist/index.node.mjs\");\n/* harmony import */ var _solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @solana/codecs-data-structures */ \"(ssr)/../../node_modules/.pnpm/@solana+codecs-data-structures@3.0.3_typescript@5.9.2/node_modules/@solana/codecs-data-structures/dist/index.node.mjs\");\n/* harmony import */ var _solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @solana/codecs-numbers */ \"(ssr)/../../node_modules/.pnpm/@solana+codecs-numbers@3.0.3_typescript@5.9.2/node_modules/@solana/codecs-numbers/dist/index.node.mjs\");\n/* harmony import */ var _solana_instructions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @solana/instructions */ \"(ssr)/../../node_modules/.pnpm/@solana+instructions@3.0.3_typescript@5.9.2/node_modules/@solana/instructions/dist/index.node.mjs\");\n/* harmony import */ var _solana_functional__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @solana/functional */ \"(ssr)/../../node_modules/.pnpm/@solana+functional@3.0.3_typescript@5.9.2/node_modules/@solana/functional/dist/index.node.mjs\");\n\n\n\n\n\n\n\n\n\n// src/blockhash.ts\nfunction isTransactionMessageWithBlockhashLifetime(transactionMessage) {\n  return \"lifetimeConstraint\" in transactionMessage && typeof transactionMessage.lifetimeConstraint.blockhash === \"string\" && typeof transactionMessage.lifetimeConstraint.lastValidBlockHeight === \"bigint\" && (0,_solana_rpc_types__WEBPACK_IMPORTED_MODULE_0__.isBlockhash)(transactionMessage.lifetimeConstraint.blockhash);\n}\nfunction assertIsTransactionMessageWithBlockhashLifetime(transactionMessage) {\n  if (!isTransactionMessageWithBlockhashLifetime(transactionMessage)) {\n    throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__EXPECTED_BLOCKHASH_LIFETIME);\n  }\n}\nfunction setTransactionMessageLifetimeUsingBlockhash(blockhashLifetimeConstraint, transactionMessage) {\n  if (\"lifetimeConstraint\" in transactionMessage && transactionMessage.lifetimeConstraint && \"blockhash\" in transactionMessage.lifetimeConstraint && transactionMessage.lifetimeConstraint.blockhash === blockhashLifetimeConstraint.blockhash && transactionMessage.lifetimeConstraint.lastValidBlockHeight === blockhashLifetimeConstraint.lastValidBlockHeight) {\n    return transactionMessage;\n  }\n  return Object.freeze({\n    ...transactionMessage,\n    lifetimeConstraint: Object.freeze(blockhashLifetimeConstraint)\n  });\n}\nfunction assertValidBaseString(alphabet4, testValue, givenValue = testValue) {\n  if (!testValue.match(new RegExp(`^[${alphabet4}]*$`))) {\n    throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__CODECS__INVALID_STRING_FOR_BASE, {\n      alphabet: alphabet4,\n      base: alphabet4.length,\n      value: givenValue\n    });\n  }\n}\nvar getBaseXEncoder = (alphabet4) => {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.createEncoder)({\n    getSizeFromValue: (value) => {\n      const [leadingZeroes, tailChars] = partitionLeadingZeroes(value, alphabet4[0]);\n      if (!tailChars) return value.length;\n      const base10Number = getBigIntFromBaseX(tailChars, alphabet4);\n      return leadingZeroes.length + Math.ceil(base10Number.toString(16).length / 2);\n    },\n    write(value, bytes, offset) {\n      assertValidBaseString(alphabet4, value);\n      if (value === \"\") return offset;\n      const [leadingZeroes, tailChars] = partitionLeadingZeroes(value, alphabet4[0]);\n      if (!tailChars) {\n        bytes.set(new Uint8Array(leadingZeroes.length).fill(0), offset);\n        return offset + leadingZeroes.length;\n      }\n      let base10Number = getBigIntFromBaseX(tailChars, alphabet4);\n      const tailBytes = [];\n      while (base10Number > 0n) {\n        tailBytes.unshift(Number(base10Number % 256n));\n        base10Number /= 256n;\n      }\n      const bytesToAdd = [...Array(leadingZeroes.length).fill(0), ...tailBytes];\n      bytes.set(bytesToAdd, offset);\n      return offset + bytesToAdd.length;\n    }\n  });\n};\nvar getBaseXDecoder = (alphabet4) => {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.createDecoder)({\n    read(rawBytes, offset) {\n      const bytes = offset === 0 ? rawBytes : rawBytes.slice(offset);\n      if (bytes.length === 0) return [\"\", 0];\n      let trailIndex = bytes.findIndex((n) => n !== 0);\n      trailIndex = trailIndex === -1 ? bytes.length : trailIndex;\n      const leadingZeroes = alphabet4[0].repeat(trailIndex);\n      if (trailIndex === bytes.length) return [leadingZeroes, rawBytes.length];\n      const base10Number = bytes.slice(trailIndex).reduce((sum, byte) => sum * 256n + BigInt(byte), 0n);\n      const tailChars = getBaseXFromBigInt(base10Number, alphabet4);\n      return [leadingZeroes + tailChars, rawBytes.length];\n    }\n  });\n};\nfunction partitionLeadingZeroes(value, zeroCharacter) {\n  const [leadingZeros, tailChars] = value.split(new RegExp(`((?!${zeroCharacter}).*)`));\n  return [leadingZeros, tailChars];\n}\nfunction getBigIntFromBaseX(value, alphabet4) {\n  const base = BigInt(alphabet4.length);\n  let sum = 0n;\n  for (const char of value) {\n    sum *= base;\n    sum += BigInt(alphabet4.indexOf(char));\n  }\n  return sum;\n}\nfunction getBaseXFromBigInt(value, alphabet4) {\n  const base = BigInt(alphabet4.length);\n  const tailChars = [];\n  while (value > 0n) {\n    tailChars.unshift(alphabet4[Number(value % base)]);\n    value /= base;\n  }\n  return tailChars.join(\"\");\n}\nvar alphabet2 = \"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz\";\nvar getBase58Encoder = () => getBaseXEncoder(alphabet2);\nvar getBase58Decoder = () => getBaseXDecoder(alphabet2);\nvar memoizedAddressTableLookupEncoder;\nfunction getAddressTableLookupEncoder() {\n  if (!memoizedAddressTableLookupEncoder) {\n    const indexEncoder = (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayEncoder)((0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Encoder)(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Encoder)() });\n    memoizedAddressTableLookupEncoder = (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructEncoder)([\n      [\"lookupTableAddress\", (0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.getAddressEncoder)()],\n      [\"writableIndexes\", indexEncoder],\n      [\"readonlyIndexes\", indexEncoder]\n    ]);\n  }\n  return memoizedAddressTableLookupEncoder;\n}\nvar memoizedAddressTableLookupDecoder;\nfunction getAddressTableLookupDecoder() {\n  if (!memoizedAddressTableLookupDecoder) {\n    const indexEncoder = (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayDecoder)((0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Decoder)(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Decoder)() });\n    memoizedAddressTableLookupDecoder = (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructDecoder)([\n      [\"lookupTableAddress\", (0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.getAddressDecoder)()],\n      [\"writableIndexes\", indexEncoder],\n      [\"readonlyIndexes\", indexEncoder]\n    ]);\n  }\n  return memoizedAddressTableLookupDecoder;\n}\nvar memoizedU8Encoder;\nfunction getMemoizedU8Encoder() {\n  if (!memoizedU8Encoder) memoizedU8Encoder = (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Encoder)();\n  return memoizedU8Encoder;\n}\nvar memoizedU8Decoder;\nfunction getMemoizedU8Decoder() {\n  if (!memoizedU8Decoder) memoizedU8Decoder = (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Decoder)();\n  return memoizedU8Decoder;\n}\nfunction getMessageHeaderEncoder() {\n  return (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructEncoder)([\n    [\"numSignerAccounts\", getMemoizedU8Encoder()],\n    [\"numReadonlySignerAccounts\", getMemoizedU8Encoder()],\n    [\"numReadonlyNonSignerAccounts\", getMemoizedU8Encoder()]\n  ]);\n}\nfunction getMessageHeaderDecoder() {\n  return (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructDecoder)([\n    [\"numSignerAccounts\", getMemoizedU8Decoder()],\n    [\"numReadonlySignerAccounts\", getMemoizedU8Decoder()],\n    [\"numReadonlyNonSignerAccounts\", getMemoizedU8Decoder()]\n  ]);\n}\nvar memoizedGetInstructionEncoder;\nfunction getInstructionEncoder() {\n  if (!memoizedGetInstructionEncoder) {\n    memoizedGetInstructionEncoder = (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.transformEncoder)(\n      (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructEncoder)([\n        [\"programAddressIndex\", (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Encoder)()],\n        [\"accountIndices\", (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayEncoder)((0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Encoder)(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Encoder)() })],\n        [\"data\", (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.addEncoderSizePrefix)((0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getBytesEncoder)(), (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Encoder)())]\n      ]),\n      // Convert an instruction to have all fields defined\n      (instruction) => {\n        if (instruction.accountIndices !== void 0 && instruction.data !== void 0) {\n          return instruction;\n        }\n        return {\n          ...instruction,\n          accountIndices: instruction.accountIndices ?? [],\n          data: instruction.data ?? new Uint8Array(0)\n        };\n      }\n    );\n  }\n  return memoizedGetInstructionEncoder;\n}\nvar memoizedGetInstructionDecoder;\nfunction getInstructionDecoder() {\n  if (!memoizedGetInstructionDecoder) {\n    memoizedGetInstructionDecoder = (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.transformDecoder)(\n      (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructDecoder)([\n        [\"programAddressIndex\", (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Decoder)()],\n        [\"accountIndices\", (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayDecoder)((0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getU8Decoder)(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Decoder)() })],\n        [\n          \"data\",\n          (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.addDecoderSizePrefix)((0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getBytesDecoder)(), (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Decoder)())\n        ]\n      ]),\n      // Convert an instruction to exclude optional fields if they are empty\n      (instruction) => {\n        if (instruction.accountIndices.length && instruction.data.byteLength) {\n          return instruction;\n        }\n        const { accountIndices, data, ...rest } = instruction;\n        return {\n          ...rest,\n          ...accountIndices.length ? { accountIndices } : null,\n          ...data.byteLength ? { data } : null\n        };\n      }\n    );\n  }\n  return memoizedGetInstructionDecoder;\n}\nvar VERSION_FLAG_MASK = 128;\nfunction getTransactionVersionEncoder() {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.createEncoder)({\n    getSizeFromValue: (value) => value === \"legacy\" ? 0 : 1,\n    maxSize: 1,\n    write: (value, bytes, offset) => {\n      if (value === \"legacy\") {\n        return offset;\n      }\n      if (value < 0 || value > 127) {\n        throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__VERSION_NUMBER_OUT_OF_RANGE, {\n          actualVersion: value\n        });\n      }\n      bytes.set([value | VERSION_FLAG_MASK], offset);\n      return offset + 1;\n    }\n  });\n}\nfunction getTransactionVersionDecoder() {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.createDecoder)({\n    maxSize: 1,\n    read: (bytes, offset) => {\n      const firstByte = bytes[offset];\n      if ((firstByte & VERSION_FLAG_MASK) === 0) {\n        return [\"legacy\", offset];\n      } else {\n        const version = firstByte ^ VERSION_FLAG_MASK;\n        return [version, offset + 1];\n      }\n    }\n  });\n}\nfunction getTransactionVersionCodec() {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.combineCodec)(getTransactionVersionEncoder(), getTransactionVersionDecoder());\n}\n\n// src/codecs/message.ts\nfunction getCompiledMessageLegacyEncoder() {\n  return (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructEncoder)(getPreludeStructEncoderTuple());\n}\nfunction getCompiledMessageVersionedEncoder() {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.transformEncoder)(\n    (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructEncoder)([\n      ...getPreludeStructEncoderTuple(),\n      [\"addressTableLookups\", getAddressTableLookupArrayEncoder()]\n    ]),\n    (value) => {\n      if (value.version === \"legacy\") {\n        return value;\n      }\n      return {\n        ...value,\n        addressTableLookups: value.addressTableLookups ?? []\n      };\n    }\n  );\n}\nfunction getPreludeStructEncoderTuple() {\n  const lifetimeTokenEncoder = (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getUnionEncoder)(\n    [\n      // Use a 32-byte constant encoder for a missing lifetime token (index 0).\n      (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getConstantEncoder)(new Uint8Array(32)),\n      // Use a 32-byte base58 encoder for a valid lifetime token (index 1).\n      (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.fixEncoderSize)(getBase58Encoder(), 32)\n    ],\n    (value) => value === void 0 ? 0 : 1\n  );\n  return [\n    [\"version\", getTransactionVersionEncoder()],\n    [\"header\", getMessageHeaderEncoder()],\n    [\"staticAccounts\", (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayEncoder)((0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.getAddressEncoder)(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Encoder)() })],\n    [\"lifetimeToken\", lifetimeTokenEncoder],\n    [\"instructions\", (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayEncoder)(getInstructionEncoder(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Encoder)() })]\n  ];\n}\nfunction getPreludeStructDecoderTuple() {\n  return [\n    [\"version\", getTransactionVersionDecoder()],\n    [\"header\", getMessageHeaderDecoder()],\n    [\"staticAccounts\", (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayDecoder)((0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.getAddressDecoder)(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Decoder)() })],\n    [\"lifetimeToken\", (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.fixDecoderSize)(getBase58Decoder(), 32)],\n    [\"instructions\", (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayDecoder)(getInstructionDecoder(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Decoder)() })],\n    [\"addressTableLookups\", getAddressTableLookupArrayDecoder()]\n  ];\n}\nfunction getAddressTableLookupArrayEncoder() {\n  return (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayEncoder)(getAddressTableLookupEncoder(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Encoder)() });\n}\nfunction getAddressTableLookupArrayDecoder() {\n  return (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getArrayDecoder)(getAddressTableLookupDecoder(), { size: (0,_solana_codecs_numbers__WEBPACK_IMPORTED_MODULE_4__.getShortU16Decoder)() });\n}\nfunction getCompiledTransactionMessageEncoder() {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.createEncoder)({\n    getSizeFromValue: (compiledMessage) => {\n      if (compiledMessage.version === \"legacy\") {\n        return getCompiledMessageLegacyEncoder().getSizeFromValue(compiledMessage);\n      } else {\n        return getCompiledMessageVersionedEncoder().getSizeFromValue(compiledMessage);\n      }\n    },\n    write: (compiledMessage, bytes, offset) => {\n      if (compiledMessage.version === \"legacy\") {\n        return getCompiledMessageLegacyEncoder().write(compiledMessage, bytes, offset);\n      } else {\n        return getCompiledMessageVersionedEncoder().write(compiledMessage, bytes, offset);\n      }\n    }\n  });\n}\nfunction getCompiledTransactionMessageDecoder() {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.transformDecoder)(\n    (0,_solana_codecs_data_structures__WEBPACK_IMPORTED_MODULE_3__.getStructDecoder)(getPreludeStructDecoderTuple()),\n    ({ addressTableLookups, ...restOfMessage }) => {\n      if (restOfMessage.version === \"legacy\" || !addressTableLookups?.length) {\n        return restOfMessage;\n      }\n      return { ...restOfMessage, addressTableLookups };\n    }\n  );\n}\nfunction getCompiledTransactionMessageCodec() {\n  return (0,_solana_codecs_core__WEBPACK_IMPORTED_MODULE_2__.combineCodec)(getCompiledTransactionMessageEncoder(), getCompiledTransactionMessageDecoder());\n}\nfunction upsert(addressMap, address, update) {\n  addressMap[address] = update(addressMap[address] ?? { role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY });\n}\nvar TYPE = Symbol(\"AddressMapTypeProperty\");\nfunction getAddressMapFromInstructions(feePayer, instructions) {\n  const addressMap = {\n    [feePayer]: { [TYPE]: 0 /* FEE_PAYER */, role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.WRITABLE_SIGNER }\n  };\n  const addressesOfInvokedPrograms = /* @__PURE__ */ new Set();\n  for (const instruction of instructions) {\n    upsert(addressMap, instruction.programAddress, (entry) => {\n      addressesOfInvokedPrograms.add(instruction.programAddress);\n      if (TYPE in entry) {\n        if ((0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isWritableRole)(entry.role)) {\n          switch (entry[TYPE]) {\n            case 0 /* FEE_PAYER */:\n              throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__INVOKED_PROGRAMS_CANNOT_PAY_FEES, {\n                programAddress: instruction.programAddress\n              });\n            default:\n              throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__INVOKED_PROGRAMS_MUST_NOT_BE_WRITABLE, {\n                programAddress: instruction.programAddress\n              });\n          }\n        }\n        if (entry[TYPE] === 2 /* STATIC */) {\n          return entry;\n        }\n      }\n      return { [TYPE]: 2 /* STATIC */, role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY };\n    });\n    let addressComparator;\n    if (!instruction.accounts) {\n      continue;\n    }\n    for (const account of instruction.accounts) {\n      upsert(addressMap, account.address, (entry) => {\n        const {\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          address: _,\n          ...accountMeta\n        } = account;\n        if (TYPE in entry) {\n          switch (entry[TYPE]) {\n            case 0 /* FEE_PAYER */:\n              return entry;\n            case 1 /* LOOKUP_TABLE */: {\n              const nextRole = (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.mergeRoles)(entry.role, accountMeta.role);\n              if (\"lookupTableAddress\" in accountMeta) {\n                const shouldReplaceEntry = (\n                  // Consider using the new LOOKUP_TABLE if its address is different...\n                  entry.lookupTableAddress !== accountMeta.lookupTableAddress && // ...and sorts before the existing one.\n                  (addressComparator ||= (0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.getAddressComparator)())(\n                    accountMeta.lookupTableAddress,\n                    entry.lookupTableAddress\n                  ) < 0\n                );\n                if (shouldReplaceEntry) {\n                  return {\n                    [TYPE]: 1 /* LOOKUP_TABLE */,\n                    ...accountMeta,\n                    role: nextRole\n                  };\n                }\n              } else if ((0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isSignerRole)(accountMeta.role)) {\n                return {\n                  [TYPE]: 2 /* STATIC */,\n                  role: nextRole\n                };\n              }\n              if (entry.role !== nextRole) {\n                return {\n                  ...entry,\n                  role: nextRole\n                };\n              } else {\n                return entry;\n              }\n            }\n            case 2 /* STATIC */: {\n              const nextRole = (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.mergeRoles)(entry.role, accountMeta.role);\n              if (\n                // Check to see if this address represents a program that is invoked\n                // in this transaction.\n                addressesOfInvokedPrograms.has(account.address)\n              ) {\n                if ((0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isWritableRole)(accountMeta.role)) {\n                  throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(\n                    _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__INVOKED_PROGRAMS_MUST_NOT_BE_WRITABLE,\n                    {\n                      programAddress: account.address\n                    }\n                  );\n                }\n                if (entry.role !== nextRole) {\n                  return {\n                    ...entry,\n                    role: nextRole\n                  };\n                } else {\n                  return entry;\n                }\n              } else if (\"lookupTableAddress\" in accountMeta && // Static accounts can be 'upgraded' to lookup table accounts as\n              // long as they are not require to sign the transaction.\n              !(0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isSignerRole)(entry.role)) {\n                return {\n                  ...accountMeta,\n                  [TYPE]: 1 /* LOOKUP_TABLE */,\n                  role: nextRole\n                };\n              } else {\n                if (entry.role !== nextRole) {\n                  return {\n                    ...entry,\n                    role: nextRole\n                  };\n                } else {\n                  return entry;\n                }\n              }\n            }\n          }\n        }\n        if (\"lookupTableAddress\" in accountMeta) {\n          return {\n            ...accountMeta,\n            [TYPE]: 1 /* LOOKUP_TABLE */\n          };\n        } else {\n          return {\n            ...accountMeta,\n            [TYPE]: 2 /* STATIC */\n          };\n        }\n      });\n    }\n  }\n  return addressMap;\n}\nfunction getOrderedAccountsFromAddressMap(addressMap) {\n  let addressComparator;\n  const orderedAccounts = Object.entries(addressMap).sort(([leftAddress, leftEntry], [rightAddress, rightEntry]) => {\n    if (leftEntry[TYPE] !== rightEntry[TYPE]) {\n      if (leftEntry[TYPE] === 0 /* FEE_PAYER */) {\n        return -1;\n      } else if (rightEntry[TYPE] === 0 /* FEE_PAYER */) {\n        return 1;\n      } else if (leftEntry[TYPE] === 2 /* STATIC */) {\n        return -1;\n      } else if (rightEntry[TYPE] === 2 /* STATIC */) {\n        return 1;\n      }\n    }\n    const leftIsSigner = (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isSignerRole)(leftEntry.role);\n    if (leftIsSigner !== (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isSignerRole)(rightEntry.role)) {\n      return leftIsSigner ? -1 : 1;\n    }\n    const leftIsWritable = (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isWritableRole)(leftEntry.role);\n    if (leftIsWritable !== (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isWritableRole)(rightEntry.role)) {\n      return leftIsWritable ? -1 : 1;\n    }\n    addressComparator ||= (0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.getAddressComparator)();\n    if (leftEntry[TYPE] === 1 /* LOOKUP_TABLE */ && rightEntry[TYPE] === 1 /* LOOKUP_TABLE */ && leftEntry.lookupTableAddress !== rightEntry.lookupTableAddress) {\n      return addressComparator(leftEntry.lookupTableAddress, rightEntry.lookupTableAddress);\n    } else {\n      return addressComparator(leftAddress, rightAddress);\n    }\n  }).map(([address, addressMeta]) => ({\n    address,\n    ...addressMeta\n  }));\n  return orderedAccounts;\n}\nfunction getCompiledAddressTableLookups(orderedAccounts) {\n  const index = {};\n  for (const account of orderedAccounts) {\n    if (!(\"lookupTableAddress\" in account)) {\n      continue;\n    }\n    const entry = index[account.lookupTableAddress] ||= {\n      readonlyIndexes: [],\n      writableIndexes: []\n    };\n    if (account.role === _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.WRITABLE) {\n      entry.writableIndexes.push(account.addressIndex);\n    } else {\n      entry.readonlyIndexes.push(account.addressIndex);\n    }\n  }\n  return Object.keys(index).sort((0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.getAddressComparator)()).map((lookupTableAddress) => ({\n    lookupTableAddress,\n    ...index[lookupTableAddress]\n  }));\n}\nfunction getCompiledMessageHeader(orderedAccounts) {\n  let numReadonlyNonSignerAccounts = 0;\n  let numReadonlySignerAccounts = 0;\n  let numSignerAccounts = 0;\n  for (const account of orderedAccounts) {\n    if (\"lookupTableAddress\" in account) {\n      break;\n    }\n    const accountIsWritable = (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isWritableRole)(account.role);\n    if ((0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isSignerRole)(account.role)) {\n      numSignerAccounts++;\n      if (!accountIsWritable) {\n        numReadonlySignerAccounts++;\n      }\n    } else if (!accountIsWritable) {\n      numReadonlyNonSignerAccounts++;\n    }\n  }\n  return {\n    numReadonlyNonSignerAccounts,\n    numReadonlySignerAccounts,\n    numSignerAccounts\n  };\n}\n\n// src/compile/instructions.ts\nfunction getAccountIndex(orderedAccounts) {\n  const out = {};\n  for (const [index, account] of orderedAccounts.entries()) {\n    out[account.address] = index;\n  }\n  return out;\n}\nfunction getCompiledInstructions(instructions, orderedAccounts) {\n  const accountIndex = getAccountIndex(orderedAccounts);\n  return instructions.map(({ accounts, data, programAddress }) => {\n    return {\n      programAddressIndex: accountIndex[programAddress],\n      ...accounts ? { accountIndices: accounts.map(({ address }) => accountIndex[address]) } : null,\n      ...data ? { data } : null\n    };\n  });\n}\n\n// src/compile/lifetime-token.ts\nfunction getCompiledLifetimeToken(lifetimeConstraint) {\n  if (\"nonce\" in lifetimeConstraint) {\n    return lifetimeConstraint.nonce;\n  }\n  return lifetimeConstraint.blockhash;\n}\n\n// src/compile/static-accounts.ts\nfunction getCompiledStaticAccounts(orderedAccounts) {\n  const firstLookupTableAccountIndex = orderedAccounts.findIndex((account) => \"lookupTableAddress\" in account);\n  const orderedStaticAccounts = firstLookupTableAccountIndex === -1 ? orderedAccounts : orderedAccounts.slice(0, firstLookupTableAccountIndex);\n  return orderedStaticAccounts.map(({ address }) => address);\n}\n\n// src/compile/message.ts\nfunction compileTransactionMessage(transactionMessage) {\n  const addressMap = getAddressMapFromInstructions(\n    transactionMessage.feePayer.address,\n    transactionMessage.instructions\n  );\n  const orderedAccounts = getOrderedAccountsFromAddressMap(addressMap);\n  const lifetimeConstraint = transactionMessage.lifetimeConstraint;\n  return {\n    ...transactionMessage.version !== \"legacy\" ? { addressTableLookups: getCompiledAddressTableLookups(orderedAccounts) } : null,\n    ...lifetimeConstraint ? { lifetimeToken: getCompiledLifetimeToken(lifetimeConstraint) } : null,\n    header: getCompiledMessageHeader(orderedAccounts),\n    instructions: getCompiledInstructions(transactionMessage.instructions, orderedAccounts),\n    staticAccounts: getCompiledStaticAccounts(orderedAccounts),\n    version: transactionMessage.version\n  };\n}\nfunction findAddressInLookupTables(address, role, addressesByLookupTableAddress) {\n  for (const [lookupTableAddress, addresses] of Object.entries(addressesByLookupTableAddress)) {\n    for (let i = 0; i < addresses.length; i++) {\n      if (address === addresses[i]) {\n        return {\n          address,\n          addressIndex: i,\n          lookupTableAddress,\n          role\n        };\n      }\n    }\n  }\n}\nfunction compressTransactionMessageUsingAddressLookupTables(transactionMessage, addressesByLookupTableAddress) {\n  const lookupTableAddresses = new Set(Object.values(addressesByLookupTableAddress).flatMap((a) => a));\n  const newInstructions = [];\n  let updatedAnyInstructions = false;\n  for (const instruction of transactionMessage.instructions) {\n    if (!instruction.accounts) {\n      newInstructions.push(instruction);\n      continue;\n    }\n    const newAccounts = [];\n    let updatedAnyAccounts = false;\n    for (const account of instruction.accounts) {\n      if (\"lookupTableAddress\" in account || !lookupTableAddresses.has(account.address) || (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isSignerRole)(account.role)) {\n        newAccounts.push(account);\n        continue;\n      }\n      const lookupMetaAccount = findAddressInLookupTables(\n        account.address,\n        account.role,\n        addressesByLookupTableAddress\n      );\n      newAccounts.push(Object.freeze(lookupMetaAccount));\n      updatedAnyAccounts = true;\n      updatedAnyInstructions = true;\n    }\n    newInstructions.push(\n      Object.freeze(updatedAnyAccounts ? { ...instruction, accounts: newAccounts } : instruction)\n    );\n  }\n  return Object.freeze(\n    updatedAnyInstructions ? { ...transactionMessage, instructions: newInstructions } : transactionMessage\n  );\n}\n\n// src/create-transaction-message.ts\nfunction createTransactionMessage(config) {\n  return Object.freeze({\n    instructions: Object.freeze([]),\n    version: config.version\n  });\n}\nvar RECENT_BLOCKHASHES_SYSVAR_ADDRESS = \"SysvarRecentB1ockHashes11111111111111111111\";\nvar SYSTEM_PROGRAM_ADDRESS = \"11111111111111111111111111111111\";\nfunction createAdvanceNonceAccountInstruction(nonceAccountAddress, nonceAuthorityAddress) {\n  return {\n    accounts: [\n      { address: nonceAccountAddress, role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.WRITABLE },\n      {\n        address: RECENT_BLOCKHASHES_SYSVAR_ADDRESS,\n        role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY\n      },\n      { address: nonceAuthorityAddress, role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY_SIGNER }\n    ],\n    data: new Uint8Array([4, 0, 0, 0]),\n    programAddress: SYSTEM_PROGRAM_ADDRESS\n  };\n}\nfunction isAdvanceNonceAccountInstruction(instruction) {\n  return instruction.programAddress === SYSTEM_PROGRAM_ADDRESS && // Test for `AdvanceNonceAccount` instruction data\n  instruction.data != null && isAdvanceNonceAccountInstructionData(instruction.data) && // Test for exactly 3 accounts\n  instruction.accounts?.length === 3 && // First account is nonce account address\n  instruction.accounts[0].address != null && instruction.accounts[0].role === _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.WRITABLE && // Second account is recent blockhashes sysvar\n  instruction.accounts[1].address === RECENT_BLOCKHASHES_SYSVAR_ADDRESS && instruction.accounts[1].role === _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY && // Third account is nonce authority account\n  instruction.accounts[2].address != null && (0,_solana_instructions__WEBPACK_IMPORTED_MODULE_6__.isSignerRole)(instruction.accounts[2].role);\n}\nfunction isAdvanceNonceAccountInstructionData(data) {\n  return data.byteLength === 4 && data[0] === 4 && data[1] === 0 && data[2] === 0 && data[3] === 0;\n}\n\n// src/durable-nonce.ts\nfunction isTransactionMessageWithDurableNonceLifetime(transactionMessage) {\n  return \"lifetimeConstraint\" in transactionMessage && typeof transactionMessage.lifetimeConstraint.nonce === \"string\" && transactionMessage.instructions[0] != null && isAdvanceNonceAccountInstruction(transactionMessage.instructions[0]);\n}\nfunction assertIsTransactionMessageWithDurableNonceLifetime(transactionMessage) {\n  if (!isTransactionMessageWithDurableNonceLifetime(transactionMessage)) {\n    throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__EXPECTED_NONCE_LIFETIME);\n  }\n}\nfunction isAdvanceNonceAccountInstructionForNonce(instruction, nonceAccountAddress, nonceAuthorityAddress) {\n  return instruction.accounts[0].address === nonceAccountAddress && instruction.accounts[2].address === nonceAuthorityAddress;\n}\nfunction setTransactionMessageLifetimeUsingDurableNonce({\n  nonce,\n  nonceAccountAddress,\n  nonceAuthorityAddress\n}, transactionMessage) {\n  let newInstructions;\n  const firstInstruction = transactionMessage.instructions[0];\n  if (firstInstruction && isAdvanceNonceAccountInstruction(firstInstruction)) {\n    if (isAdvanceNonceAccountInstructionForNonce(firstInstruction, nonceAccountAddress, nonceAuthorityAddress)) {\n      if (isTransactionMessageWithDurableNonceLifetime(transactionMessage) && transactionMessage.lifetimeConstraint.nonce === nonce) {\n        return transactionMessage;\n      } else {\n        newInstructions = [firstInstruction, ...transactionMessage.instructions.slice(1)];\n      }\n    } else {\n      newInstructions = [\n        Object.freeze(createAdvanceNonceAccountInstruction(nonceAccountAddress, nonceAuthorityAddress)),\n        ...transactionMessage.instructions.slice(1)\n      ];\n    }\n  } else {\n    newInstructions = [\n      Object.freeze(createAdvanceNonceAccountInstruction(nonceAccountAddress, nonceAuthorityAddress)),\n      ...transactionMessage.instructions\n    ];\n  }\n  return Object.freeze({\n    ...transactionMessage,\n    instructions: Object.freeze(newInstructions),\n    lifetimeConstraint: Object.freeze({ nonce })\n  });\n}\n\n// src/fee-payer.ts\nfunction setTransactionMessageFeePayer(feePayer, transactionMessage) {\n  if (\"feePayer\" in transactionMessage && feePayer === transactionMessage.feePayer?.address && isAddressOnlyFeePayer(transactionMessage.feePayer)) {\n    return transactionMessage;\n  }\n  const out = {\n    ...transactionMessage,\n    feePayer: Object.freeze({ address: feePayer })\n  };\n  Object.freeze(out);\n  return out;\n}\nfunction isAddressOnlyFeePayer(feePayer) {\n  return !!feePayer && \"address\" in feePayer && typeof feePayer.address === \"string\" && Object.keys(feePayer).length === 1;\n}\n\n// src/instructions.ts\nfunction appendTransactionMessageInstruction(instruction, transactionMessage) {\n  return appendTransactionMessageInstructions([instruction], transactionMessage);\n}\nfunction appendTransactionMessageInstructions(instructions, transactionMessage) {\n  return Object.freeze({\n    ...transactionMessage,\n    instructions: Object.freeze([\n      ...transactionMessage.instructions,\n      ...instructions\n    ])\n  });\n}\nfunction prependTransactionMessageInstruction(instruction, transactionMessage) {\n  return prependTransactionMessageInstructions([instruction], transactionMessage);\n}\nfunction prependTransactionMessageInstructions(instructions, transactionMessage) {\n  return Object.freeze({\n    ...transactionMessage,\n    instructions: Object.freeze([\n      ...instructions,\n      ...transactionMessage.instructions\n    ])\n  });\n}\n\n// src/decompile-message.ts\nfunction getAccountMetas(message) {\n  const { header } = message;\n  const numWritableSignerAccounts = header.numSignerAccounts - header.numReadonlySignerAccounts;\n  const numWritableNonSignerAccounts = message.staticAccounts.length - header.numSignerAccounts - header.numReadonlyNonSignerAccounts;\n  const accountMetas = [];\n  let accountIndex = 0;\n  for (let i = 0; i < numWritableSignerAccounts; i++) {\n    accountMetas.push({\n      address: message.staticAccounts[accountIndex],\n      role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.WRITABLE_SIGNER\n    });\n    accountIndex++;\n  }\n  for (let i = 0; i < header.numReadonlySignerAccounts; i++) {\n    accountMetas.push({\n      address: message.staticAccounts[accountIndex],\n      role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY_SIGNER\n    });\n    accountIndex++;\n  }\n  for (let i = 0; i < numWritableNonSignerAccounts; i++) {\n    accountMetas.push({\n      address: message.staticAccounts[accountIndex],\n      role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.WRITABLE\n    });\n    accountIndex++;\n  }\n  for (let i = 0; i < header.numReadonlyNonSignerAccounts; i++) {\n    accountMetas.push({\n      address: message.staticAccounts[accountIndex],\n      role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY\n    });\n    accountIndex++;\n  }\n  return accountMetas;\n}\nfunction getAddressLookupMetas(compiledAddressTableLookups, addressesByLookupTableAddress) {\n  const compiledAddressTableLookupAddresses = compiledAddressTableLookups.map((l) => l.lookupTableAddress);\n  const missing = compiledAddressTableLookupAddresses.filter((a) => addressesByLookupTableAddress[a] === void 0);\n  if (missing.length > 0) {\n    throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__FAILED_TO_DECOMPILE_ADDRESS_LOOKUP_TABLE_CONTENTS_MISSING, {\n      lookupTableAddresses: missing\n    });\n  }\n  const readOnlyMetas = [];\n  const writableMetas = [];\n  for (const lookup of compiledAddressTableLookups) {\n    const addresses = addressesByLookupTableAddress[lookup.lookupTableAddress];\n    const readonlyIndexes = lookup.readonlyIndexes;\n    const writableIndexes = lookup.writableIndexes;\n    const highestIndex = Math.max(...readonlyIndexes, ...writableIndexes);\n    if (highestIndex >= addresses.length) {\n      throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(\n        _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__FAILED_TO_DECOMPILE_ADDRESS_LOOKUP_TABLE_INDEX_OUT_OF_RANGE,\n        {\n          highestKnownIndex: addresses.length - 1,\n          highestRequestedIndex: highestIndex,\n          lookupTableAddress: lookup.lookupTableAddress\n        }\n      );\n    }\n    const readOnlyForLookup = readonlyIndexes.map((r) => ({\n      address: addresses[r],\n      addressIndex: r,\n      lookupTableAddress: lookup.lookupTableAddress,\n      role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.READONLY\n    }));\n    readOnlyMetas.push(...readOnlyForLookup);\n    const writableForLookup = writableIndexes.map((w) => ({\n      address: addresses[w],\n      addressIndex: w,\n      lookupTableAddress: lookup.lookupTableAddress,\n      role: _solana_instructions__WEBPACK_IMPORTED_MODULE_6__.AccountRole.WRITABLE\n    }));\n    writableMetas.push(...writableForLookup);\n  }\n  return [...writableMetas, ...readOnlyMetas];\n}\nfunction convertInstruction(instruction, accountMetas) {\n  const programAddress = accountMetas[instruction.programAddressIndex]?.address;\n  if (!programAddress) {\n    throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__FAILED_TO_DECOMPILE_INSTRUCTION_PROGRAM_ADDRESS_NOT_FOUND, {\n      index: instruction.programAddressIndex\n    });\n  }\n  const accounts = instruction.accountIndices?.map((accountIndex) => accountMetas[accountIndex]);\n  const { data } = instruction;\n  return Object.freeze({\n    programAddress,\n    ...accounts && accounts.length ? { accounts: Object.freeze(accounts) } : {},\n    ...data && data.length ? { data } : {}\n  });\n}\nfunction getLifetimeConstraint(messageLifetimeToken, firstInstruction, lastValidBlockHeight) {\n  if (!firstInstruction || !isAdvanceNonceAccountInstruction(firstInstruction)) {\n    return {\n      blockhash: messageLifetimeToken,\n      lastValidBlockHeight: lastValidBlockHeight ?? 2n ** 64n - 1n\n      // U64 MAX\n    };\n  } else {\n    const nonceAccountAddress = firstInstruction.accounts[0].address;\n    (0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.assertIsAddress)(nonceAccountAddress);\n    const nonceAuthorityAddress = firstInstruction.accounts[2].address;\n    (0,_solana_addresses__WEBPACK_IMPORTED_MODULE_5__.assertIsAddress)(nonceAuthorityAddress);\n    return {\n      nonce: messageLifetimeToken,\n      nonceAccountAddress,\n      nonceAuthorityAddress\n    };\n  }\n}\nfunction decompileTransactionMessage(compiledTransactionMessage, config) {\n  const feePayer = compiledTransactionMessage.staticAccounts[0];\n  if (!feePayer) {\n    throw new _solana_errors__WEBPACK_IMPORTED_MODULE_1__.SolanaError(_solana_errors__WEBPACK_IMPORTED_MODULE_1__.SOLANA_ERROR__TRANSACTION__FAILED_TO_DECOMPILE_FEE_PAYER_MISSING);\n  }\n  const accountMetas = getAccountMetas(compiledTransactionMessage);\n  const accountLookupMetas = \"addressTableLookups\" in compiledTransactionMessage && compiledTransactionMessage.addressTableLookups !== void 0 && compiledTransactionMessage.addressTableLookups.length > 0 ? getAddressLookupMetas(\n    compiledTransactionMessage.addressTableLookups,\n    config?.addressesByLookupTableAddress ?? {}\n  ) : [];\n  const transactionMetas = [...accountMetas, ...accountLookupMetas];\n  const instructions = compiledTransactionMessage.instructions.map(\n    (compiledInstruction) => convertInstruction(compiledInstruction, transactionMetas)\n  );\n  const firstInstruction = instructions[0];\n  const lifetimeConstraint = getLifetimeConstraint(\n    compiledTransactionMessage.lifetimeToken,\n    firstInstruction,\n    config?.lastValidBlockHeight\n  );\n  return (0,_solana_functional__WEBPACK_IMPORTED_MODULE_7__.pipe)(\n    createTransactionMessage({ version: compiledTransactionMessage.version }),\n    (m) => setTransactionMessageFeePayer(feePayer, m),\n    (m) => instructions.reduce(\n      (acc, instruction) => appendTransactionMessageInstruction(instruction, acc),\n      m\n    ),\n    (m) => \"blockhash\" in lifetimeConstraint ? setTransactionMessageLifetimeUsingBlockhash(lifetimeConstraint, m) : setTransactionMessageLifetimeUsingDurableNonce(lifetimeConstraint, m)\n  );\n}\n\n\n//# sourceMappingURL=index.node.mjs.map\n//# sourceMappingURL=index.node.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0Bzb2xhbmErdHJhbnNhY3Rpb24tbWVzc2FnZXNAMy4wLjNfZmFzdGVzdHNtYWxsZXN0dGV4dGVuY29kZXJkZWNvZGVyQDEuMC4yMl90eXBlc2NyaXB0QDUuOS4yL25vZGVfbW9kdWxlcy9Ac29sYW5hL3RyYW5zYWN0aW9uLW1lc3NhZ2VzL2Rpc3QvaW5kZXgubm9kZS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXFzQjtBQUNycEI7QUFDZ0U7QUFDaUY7QUFDSjtBQUNqRjtBQUNmO0FBQ25EOztBQUUxQztBQUNBO0FBQ0EsZ05BQWdOLDhEQUFXO0FBQzNOO0FBQ0E7QUFDQTtBQUNBLGNBQWMsdURBQVcsQ0FBQyxrR0FBc0Q7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSx1Q0FBdUMsVUFBVTtBQUNqRCxjQUFjLHVEQUFXLENBQUMseUZBQTZDO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTLGtFQUFhO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxTQUFTLGtFQUFhO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGtFQUFrRSxjQUFjO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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L3phbWEtZGV2L2ZoZXZtLXJlYWN0LXRlbXBsYXRlL25vZGVfbW9kdWxlcy8ucG5wbS9Ac29sYW5hK3RyYW5zYWN0aW9uLW1lc3NhZ2VzQDMuMC4zX2Zhc3Rlc3RzbWFsbGVzdHRleHRlbmNvZGVyZGVjb2RlckAxLjAuMjJfdHlwZXNjcmlwdEA1LjkuMi9ub2RlX21vZHVsZXMvQHNvbGFuYS90cmFuc2FjdGlvbi1tZXNzYWdlcy9kaXN0L2luZGV4Lm5vZGUubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNvbGFuYUVycm9yLCBTT0xBTkFfRVJST1JfX1RSQU5TQUNUSU9OX19FWFBFQ1RFRF9CTE9DS0hBU0hfTElGRVRJTUUsIFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX1ZFUlNJT05fTlVNQkVSX09VVF9PRl9SQU5HRSwgU09MQU5BX0VSUk9SX19UUkFOU0FDVElPTl9fRVhQRUNURURfTk9OQ0VfTElGRVRJTUUsIFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX0ZBSUxFRF9UT19ERUNPTVBJTEVfRkVFX1BBWUVSX01JU1NJTkcsIFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX0ZBSUxFRF9UT19ERUNPTVBJTEVfQUREUkVTU19MT09LVVBfVEFCTEVfQ09OVEVOVFNfTUlTU0lORywgU09MQU5BX0VSUk9SX19UUkFOU0FDVElPTl9fRkFJTEVEX1RPX0RFQ09NUElMRV9BRERSRVNTX0xPT0tVUF9UQUJMRV9JTkRFWF9PVVRfT0ZfUkFOR0UsIFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX0ZBSUxFRF9UT19ERUNPTVBJTEVfSU5TVFJVQ1RJT05fUFJPR1JBTV9BRERSRVNTX05PVF9GT1VORCwgU09MQU5BX0VSUk9SX19DT0RFQ1NfX0lOVkFMSURfU1RSSU5HX0ZPUl9CQVNFLCBTT0xBTkFfRVJST1JfX1RSQU5TQUNUSU9OX19JTlZPS0VEX1BST0dSQU1TX01VU1RfTk9UX0JFX1dSSVRBQkxFLCBTT0xBTkFfRVJST1JfX1RSQU5TQUNUSU9OX19JTlZPS0VEX1BST0dSQU1TX0NBTk5PVF9QQVlfRkVFUyB9IGZyb20gJ0Bzb2xhbmEvZXJyb3JzJztcbmltcG9ydCB7IGlzQmxvY2toYXNoIH0gZnJvbSAnQHNvbGFuYS9ycGMtdHlwZXMnO1xuaW1wb3J0IHsgZ2V0QWRkcmVzc0RlY29kZXIsIGdldEFkZHJlc3NDb21wYXJhdG9yLCBhc3NlcnRJc0FkZHJlc3MsIGdldEFkZHJlc3NFbmNvZGVyIH0gZnJvbSAnQHNvbGFuYS9hZGRyZXNzZXMnO1xuaW1wb3J0IHsgY3JlYXRlRW5jb2RlciwgY3JlYXRlRGVjb2RlciwgY29tYmluZUNvZGVjLCB0cmFuc2Zvcm1EZWNvZGVyLCB0cmFuc2Zvcm1FbmNvZGVyLCBmaXhEZWNvZGVyU2l6ZSwgZml4RW5jb2RlclNpemUsIGFkZERlY29kZXJTaXplUHJlZml4LCBhZGRFbmNvZGVyU2l6ZVByZWZpeCB9IGZyb20gJ0Bzb2xhbmEvY29kZWNzLWNvcmUnO1xuaW1wb3J0IHsgZ2V0U3RydWN0RGVjb2RlciwgZ2V0U3RydWN0RW5jb2RlciwgZ2V0QXJyYXlEZWNvZGVyLCBnZXRVbmlvbkVuY29kZXIsIGdldENvbnN0YW50RW5jb2RlciwgZ2V0QXJyYXlFbmNvZGVyLCBnZXRCeXRlc0RlY29kZXIsIGdldEJ5dGVzRW5jb2RlciB9IGZyb20gJ0Bzb2xhbmEvY29kZWNzLWRhdGEtc3RydWN0dXJlcyc7XG5pbXBvcnQgeyBnZXRTaG9ydFUxNkRlY29kZXIsIGdldFNob3J0VTE2RW5jb2RlciwgZ2V0VThEZWNvZGVyLCBnZXRVOEVuY29kZXIgfSBmcm9tICdAc29sYW5hL2NvZGVjcy1udW1iZXJzJztcbmltcG9ydCB7IGlzU2lnbmVyUm9sZSwgQWNjb3VudFJvbGUsIGlzV3JpdGFibGVSb2xlLCBtZXJnZVJvbGVzIH0gZnJvbSAnQHNvbGFuYS9pbnN0cnVjdGlvbnMnO1xuaW1wb3J0IHsgcGlwZSB9IGZyb20gJ0Bzb2xhbmEvZnVuY3Rpb25hbCc7XG5cbi8vIHNyYy9ibG9ja2hhc2gudHNcbmZ1bmN0aW9uIGlzVHJhbnNhY3Rpb25NZXNzYWdlV2l0aEJsb2NraGFzaExpZmV0aW1lKHRyYW5zYWN0aW9uTWVzc2FnZSkge1xuICByZXR1cm4gXCJsaWZldGltZUNvbnN0cmFpbnRcIiBpbiB0cmFuc2FjdGlvbk1lc3NhZ2UgJiYgdHlwZW9mIHRyYW5zYWN0aW9uTWVzc2FnZS5saWZldGltZUNvbnN0cmFpbnQuYmxvY2toYXNoID09PSBcInN0cmluZ1wiICYmIHR5cGVvZiB0cmFuc2FjdGlvbk1lc3NhZ2UubGlmZXRpbWVDb25zdHJhaW50Lmxhc3RWYWxpZEJsb2NrSGVpZ2h0ID09PSBcImJpZ2ludFwiICYmIGlzQmxvY2toYXNoKHRyYW5zYWN0aW9uTWVzc2FnZS5saWZldGltZUNvbnN0cmFpbnQuYmxvY2toYXNoKTtcbn1cbmZ1bmN0aW9uIGFzc2VydElzVHJhbnNhY3Rpb25NZXNzYWdlV2l0aEJsb2NraGFzaExpZmV0aW1lKHRyYW5zYWN0aW9uTWVzc2FnZSkge1xuICBpZiAoIWlzVHJhbnNhY3Rpb25NZXNzYWdlV2l0aEJsb2NraGFzaExpZmV0aW1lKHRyYW5zYWN0aW9uTWVzc2FnZSkpIHtcbiAgICB0aHJvdyBuZXcgU29sYW5hRXJyb3IoU09MQU5BX0VSUk9SX19UUkFOU0FDVElPTl9fRVhQRUNURURfQkxPQ0tIQVNIX0xJRkVUSU1FKTtcbiAgfVxufVxuZnVuY3Rpb24gc2V0VHJhbnNhY3Rpb25NZXNzYWdlTGlmZXRpbWVVc2luZ0Jsb2NraGFzaChibG9ja2hhc2hMaWZldGltZUNvbnN0cmFpbnQsIHRyYW5zYWN0aW9uTWVzc2FnZSkge1xuICBpZiAoXCJsaWZldGltZUNvbnN0cmFpbnRcIiBpbiB0cmFuc2FjdGlvbk1lc3NhZ2UgJiYgdHJhbnNhY3Rpb25NZXNzYWdlLmxpZmV0aW1lQ29uc3RyYWludCAmJiBcImJsb2NraGFzaFwiIGluIHRyYW5zYWN0aW9uTWVzc2FnZS5saWZldGltZUNvbnN0cmFpbnQgJiYgdHJhbnNhY3Rpb25NZXNzYWdlLmxpZmV0aW1lQ29uc3RyYWludC5ibG9ja2hhc2ggPT09IGJsb2NraGFzaExpZmV0aW1lQ29uc3RyYWludC5ibG9ja2hhc2ggJiYgdHJhbnNhY3Rpb25NZXNzYWdlLmxpZmV0aW1lQ29uc3RyYWludC5sYXN0VmFsaWRCbG9ja0hlaWdodCA9PT0gYmxvY2toYXNoTGlmZXRpbWVDb25zdHJhaW50Lmxhc3RWYWxpZEJsb2NrSGVpZ2h0KSB7XG4gICAgcmV0dXJuIHRyYW5zYWN0aW9uTWVzc2FnZTtcbiAgfVxuICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7XG4gICAgLi4udHJhbnNhY3Rpb25NZXNzYWdlLFxuICAgIGxpZmV0aW1lQ29uc3RyYWludDogT2JqZWN0LmZyZWV6ZShibG9ja2hhc2hMaWZldGltZUNvbnN0cmFpbnQpXG4gIH0pO1xufVxuZnVuY3Rpb24gYXNzZXJ0VmFsaWRCYXNlU3RyaW5nKGFscGhhYmV0NCwgdGVzdFZhbHVlLCBnaXZlblZhbHVlID0gdGVzdFZhbHVlKSB7XG4gIGlmICghdGVzdFZhbHVlLm1hdGNoKG5ldyBSZWdFeHAoYF5bJHthbHBoYWJldDR9XSokYCkpKSB7XG4gICAgdGhyb3cgbmV3IFNvbGFuYUVycm9yKFNPTEFOQV9FUlJPUl9fQ09ERUNTX19JTlZBTElEX1NUUklOR19GT1JfQkFTRSwge1xuICAgICAgYWxwaGFiZXQ6IGFscGhhYmV0NCxcbiAgICAgIGJhc2U6IGFscGhhYmV0NC5sZW5ndGgsXG4gICAgICB2YWx1ZTogZ2l2ZW5WYWx1ZVxuICAgIH0pO1xuICB9XG59XG52YXIgZ2V0QmFzZVhFbmNvZGVyID0gKGFscGhhYmV0NCkgPT4ge1xuICByZXR1cm4gY3JlYXRlRW5jb2Rlcih7XG4gICAgZ2V0U2l6ZUZyb21WYWx1ZTogKHZhbHVlKSA9PiB7XG4gICAgICBjb25zdCBbbGVhZGluZ1plcm9lcywgdGFpbENoYXJzXSA9IHBhcnRpdGlvbkxlYWRpbmdaZXJvZXModmFsdWUsIGFscGhhYmV0NFswXSk7XG4gICAgICBpZiAoIXRhaWxDaGFycykgcmV0dXJuIHZhbHVlLmxlbmd0aDtcbiAgICAgIGNvbnN0IGJhc2UxME51bWJlciA9IGdldEJpZ0ludEZyb21CYXNlWCh0YWlsQ2hhcnMsIGFscGhhYmV0NCk7XG4gICAgICByZXR1cm4gbGVhZGluZ1plcm9lcy5sZW5ndGggKyBNYXRoLmNlaWwoYmFzZTEwTnVtYmVyLnRvU3RyaW5nKDE2KS5sZW5ndGggLyAyKTtcbiAgICB9LFxuICAgIHdyaXRlKHZhbHVlLCBieXRlcywgb2Zmc2V0KSB7XG4gICAgICBhc3NlcnRWYWxpZEJhc2VTdHJpbmcoYWxwaGFiZXQ0LCB2YWx1ZSk7XG4gICAgICBpZiAodmFsdWUgPT09IFwiXCIpIHJldHVybiBvZmZzZXQ7XG4gICAgICBjb25zdCBbbGVhZGluZ1plcm9lcywgdGFpbENoYXJzXSA9IHBhcnRpdGlvbkxlYWRpbmdaZXJvZXModmFsdWUsIGFscGhhYmV0NFswXSk7XG4gICAgICBpZiAoIXRhaWxDaGFycykge1xuICAgICAgICBieXRlcy5zZXQobmV3IFVpbnQ4QXJyYXkobGVhZGluZ1plcm9lcy5sZW5ndGgpLmZpbGwoMCksIG9mZnNldCk7XG4gICAgICAgIHJldHVybiBvZmZzZXQgKyBsZWFkaW5nWmVyb2VzLmxlbmd0aDtcbiAgICAgIH1cbiAgICAgIGxldCBiYXNlMTBOdW1iZXIgPSBnZXRCaWdJbnRGcm9tQmFzZVgodGFpbENoYXJzLCBhbHBoYWJldDQpO1xuICAgICAgY29uc3QgdGFpbEJ5dGVzID0gW107XG4gICAgICB3aGlsZSAoYmFzZTEwTnVtYmVyID4gMG4pIHtcbiAgICAgICAgdGFpbEJ5dGVzLnVuc2hpZnQoTnVtYmVyKGJhc2UxME51bWJlciAlIDI1Nm4pKTtcbiAgICAgICAgYmFzZTEwTnVtYmVyIC89IDI1Nm47XG4gICAgICB9XG4gICAgICBjb25zdCBieXRlc1RvQWRkID0gWy4uLkFycmF5KGxlYWRpbmdaZXJvZXMubGVuZ3RoKS5maWxsKDApLCAuLi50YWlsQnl0ZXNdO1xuICAgICAgYnl0ZXMuc2V0KGJ5dGVzVG9BZGQsIG9mZnNldCk7XG4gICAgICByZXR1cm4gb2Zmc2V0ICsgYnl0ZXNUb0FkZC5sZW5ndGg7XG4gICAgfVxuICB9KTtcbn07XG52YXIgZ2V0QmFzZVhEZWNvZGVyID0gKGFscGhhYmV0NCkgPT4ge1xuICByZXR1cm4gY3JlYXRlRGVjb2Rlcih7XG4gICAgcmVhZChyYXdCeXRlcywgb2Zmc2V0KSB7XG4gICAgICBjb25zdCBieXRlcyA9IG9mZnNldCA9PT0gMCA/IHJhd0J5dGVzIDogcmF3Qnl0ZXMuc2xpY2Uob2Zmc2V0KTtcbiAgICAgIGlmIChieXRlcy5sZW5ndGggPT09IDApIHJldHVybiBbXCJcIiwgMF07XG4gICAgICBsZXQgdHJhaWxJbmRleCA9IGJ5dGVzLmZpbmRJbmRleCgobikgPT4gbiAhPT0gMCk7XG4gICAgICB0cmFpbEluZGV4ID0gdHJhaWxJbmRleCA9PT0gLTEgPyBieXRlcy5sZW5ndGggOiB0cmFpbEluZGV4O1xuICAgICAgY29uc3QgbGVhZGluZ1plcm9lcyA9IGFscGhhYmV0NFswXS5yZXBlYXQodHJhaWxJbmRleCk7XG4gICAgICBpZiAodHJhaWxJbmRleCA9PT0gYnl0ZXMubGVuZ3RoKSByZXR1cm4gW2xlYWRpbmdaZXJvZXMsIHJhd0J5dGVzLmxlbmd0aF07XG4gICAgICBjb25zdCBiYXNlMTBOdW1iZXIgPSBieXRlcy5zbGljZSh0cmFpbEluZGV4KS5yZWR1Y2UoKHN1bSwgYnl0ZSkgPT4gc3VtICogMjU2biArIEJpZ0ludChieXRlKSwgMG4pO1xuICAgICAgY29uc3QgdGFpbENoYXJzID0gZ2V0QmFzZVhGcm9tQmlnSW50KGJhc2UxME51bWJlciwgYWxwaGFiZXQ0KTtcbiAgICAgIHJldHVybiBbbGVhZGluZ1plcm9lcyArIHRhaWxDaGFycywgcmF3Qnl0ZXMubGVuZ3RoXTtcbiAgICB9XG4gIH0pO1xufTtcbmZ1bmN0aW9uIHBhcnRpdGlvbkxlYWRpbmdaZXJvZXModmFsdWUsIHplcm9DaGFyYWN0ZXIpIHtcbiAgY29uc3QgW2xlYWRpbmdaZXJvcywgdGFpbENoYXJzXSA9IHZhbHVlLnNwbGl0KG5ldyBSZWdFeHAoYCgoPyEke3plcm9DaGFyYWN0ZXJ9KS4qKWApKTtcbiAgcmV0dXJuIFtsZWFkaW5nWmVyb3MsIHRhaWxDaGFyc107XG59XG5mdW5jdGlvbiBnZXRCaWdJbnRGcm9tQmFzZVgodmFsdWUsIGFscGhhYmV0NCkge1xuICBjb25zdCBiYXNlID0gQmlnSW50KGFscGhhYmV0NC5sZW5ndGgpO1xuICBsZXQgc3VtID0gMG47XG4gIGZvciAoY29uc3QgY2hhciBvZiB2YWx1ZSkge1xuICAgIHN1bSAqPSBiYXNlO1xuICAgIHN1bSArPSBCaWdJbnQoYWxwaGFiZXQ0LmluZGV4T2YoY2hhcikpO1xuICB9XG4gIHJldHVybiBzdW07XG59XG5mdW5jdGlvbiBnZXRCYXNlWEZyb21CaWdJbnQodmFsdWUsIGFscGhhYmV0NCkge1xuICBjb25zdCBiYXNlID0gQmlnSW50KGFscGhhYmV0NC5sZW5ndGgpO1xuICBjb25zdCB0YWlsQ2hhcnMgPSBbXTtcbiAgd2hpbGUgKHZhbHVlID4gMG4pIHtcbiAgICB0YWlsQ2hhcnMudW5zaGlmdChhbHBoYWJldDRbTnVtYmVyKHZhbHVlICUgYmFzZSldKTtcbiAgICB2YWx1ZSAvPSBiYXNlO1xuICB9XG4gIHJldHVybiB0YWlsQ2hhcnMuam9pbihcIlwiKTtcbn1cbnZhciBhbHBoYWJldDIgPSBcIjEyMzQ1Njc4OUFCQ0RFRkdISktMTU5QUVJTVFVWV1hZWmFiY2RlZmdoaWprbW5vcHFyc3R1dnd4eXpcIjtcbnZhciBnZXRCYXNlNThFbmNvZGVyID0gKCkgPT4gZ2V0QmFzZVhFbmNvZGVyKGFscGhhYmV0Mik7XG52YXIgZ2V0QmFzZTU4RGVjb2RlciA9ICgpID0+IGdldEJhc2VYRGVjb2RlcihhbHBoYWJldDIpO1xudmFyIG1lbW9pemVkQWRkcmVzc1RhYmxlTG9va3VwRW5jb2RlcjtcbmZ1bmN0aW9uIGdldEFkZHJlc3NUYWJsZUxvb2t1cEVuY29kZXIoKSB7XG4gIGlmICghbWVtb2l6ZWRBZGRyZXNzVGFibGVMb29rdXBFbmNvZGVyKSB7XG4gICAgY29uc3QgaW5kZXhFbmNvZGVyID0gZ2V0QXJyYXlFbmNvZGVyKGdldFU4RW5jb2RlcigpLCB7IHNpemU6IGdldFNob3J0VTE2RW5jb2RlcigpIH0pO1xuICAgIG1lbW9pemVkQWRkcmVzc1RhYmxlTG9va3VwRW5jb2RlciA9IGdldFN0cnVjdEVuY29kZXIoW1xuICAgICAgW1wibG9va3VwVGFibGVBZGRyZXNzXCIsIGdldEFkZHJlc3NFbmNvZGVyKCldLFxuICAgICAgW1wid3JpdGFibGVJbmRleGVzXCIsIGluZGV4RW5jb2Rlcl0sXG4gICAgICBbXCJyZWFkb25seUluZGV4ZXNcIiwgaW5kZXhFbmNvZGVyXVxuICAgIF0pO1xuICB9XG4gIHJldHVybiBtZW1vaXplZEFkZHJlc3NUYWJsZUxvb2t1cEVuY29kZXI7XG59XG52YXIgbWVtb2l6ZWRBZGRyZXNzVGFibGVMb29rdXBEZWNvZGVyO1xuZnVuY3Rpb24gZ2V0QWRkcmVzc1RhYmxlTG9va3VwRGVjb2RlcigpIHtcbiAgaWYgKCFtZW1vaXplZEFkZHJlc3NUYWJsZUxvb2t1cERlY29kZXIpIHtcbiAgICBjb25zdCBpbmRleEVuY29kZXIgPSBnZXRBcnJheURlY29kZXIoZ2V0VThEZWNvZGVyKCksIHsgc2l6ZTogZ2V0U2hvcnRVMTZEZWNvZGVyKCkgfSk7XG4gICAgbWVtb2l6ZWRBZGRyZXNzVGFibGVMb29rdXBEZWNvZGVyID0gZ2V0U3RydWN0RGVjb2RlcihbXG4gICAgICBbXCJsb29rdXBUYWJsZUFkZHJlc3NcIiwgZ2V0QWRkcmVzc0RlY29kZXIoKV0sXG4gICAgICBbXCJ3cml0YWJsZUluZGV4ZXNcIiwgaW5kZXhFbmNvZGVyXSxcbiAgICAgIFtcInJlYWRvbmx5SW5kZXhlc1wiLCBpbmRleEVuY29kZXJdXG4gICAgXSk7XG4gIH1cbiAgcmV0dXJuIG1lbW9pemVkQWRkcmVzc1RhYmxlTG9va3VwRGVjb2Rlcjtcbn1cbnZhciBtZW1vaXplZFU4RW5jb2RlcjtcbmZ1bmN0aW9uIGdldE1lbW9pemVkVThFbmNvZGVyKCkge1xuICBpZiAoIW1lbW9pemVkVThFbmNvZGVyKSBtZW1vaXplZFU4RW5jb2RlciA9IGdldFU4RW5jb2RlcigpO1xuICByZXR1cm4gbWVtb2l6ZWRVOEVuY29kZXI7XG59XG52YXIgbWVtb2l6ZWRVOERlY29kZXI7XG5mdW5jdGlvbiBnZXRNZW1vaXplZFU4RGVjb2RlcigpIHtcbiAgaWYgKCFtZW1vaXplZFU4RGVjb2RlcikgbWVtb2l6ZWRVOERlY29kZXIgPSBnZXRVOERlY29kZXIoKTtcbiAgcmV0dXJuIG1lbW9pemVkVThEZWNvZGVyO1xufVxuZnVuY3Rpb24gZ2V0TWVzc2FnZUhlYWRlckVuY29kZXIoKSB7XG4gIHJldHVybiBnZXRTdHJ1Y3RFbmNvZGVyKFtcbiAgICBbXCJudW1TaWduZXJBY2NvdW50c1wiLCBnZXRNZW1vaXplZFU4RW5jb2RlcigpXSxcbiAgICBbXCJudW1SZWFkb25seVNpZ25lckFjY291bnRzXCIsIGdldE1lbW9pemVkVThFbmNvZGVyKCldLFxuICAgIFtcIm51bVJlYWRvbmx5Tm9uU2lnbmVyQWNjb3VudHNcIiwgZ2V0TWVtb2l6ZWRVOEVuY29kZXIoKV1cbiAgXSk7XG59XG5mdW5jdGlvbiBnZXRNZXNzYWdlSGVhZGVyRGVjb2RlcigpIHtcbiAgcmV0dXJuIGdldFN0cnVjdERlY29kZXIoW1xuICAgIFtcIm51bVNpZ25lckFjY291bnRzXCIsIGdldE1lbW9pemVkVThEZWNvZGVyKCldLFxuICAgIFtcIm51bVJlYWRvbmx5U2lnbmVyQWNjb3VudHNcIiwgZ2V0TWVtb2l6ZWRVOERlY29kZXIoKV0sXG4gICAgW1wibnVtUmVhZG9ubHlOb25TaWduZXJBY2NvdW50c1wiLCBnZXRNZW1vaXplZFU4RGVjb2RlcigpXVxuICBdKTtcbn1cbnZhciBtZW1vaXplZEdldEluc3RydWN0aW9uRW5jb2RlcjtcbmZ1bmN0aW9uIGdldEluc3RydWN0aW9uRW5jb2RlcigpIHtcbiAgaWYgKCFtZW1vaXplZEdldEluc3RydWN0aW9uRW5jb2Rlcikge1xuICAgIG1lbW9pemVkR2V0SW5zdHJ1Y3Rpb25FbmNvZGVyID0gdHJhbnNmb3JtRW5jb2RlcihcbiAgICAgIGdldFN0cnVjdEVuY29kZXIoW1xuICAgICAgICBbXCJwcm9ncmFtQWRkcmVzc0luZGV4XCIsIGdldFU4RW5jb2RlcigpXSxcbiAgICAgICAgW1wiYWNjb3VudEluZGljZXNcIiwgZ2V0QXJyYXlFbmNvZGVyKGdldFU4RW5jb2RlcigpLCB7IHNpemU6IGdldFNob3J0VTE2RW5jb2RlcigpIH0pXSxcbiAgICAgICAgW1wiZGF0YVwiLCBhZGRFbmNvZGVyU2l6ZVByZWZpeChnZXRCeXRlc0VuY29kZXIoKSwgZ2V0U2hvcnRVMTZFbmNvZGVyKCkpXVxuICAgICAgXSksXG4gICAgICAvLyBDb252ZXJ0IGFuIGluc3RydWN0aW9uIHRvIGhhdmUgYWxsIGZpZWxkcyBkZWZpbmVkXG4gICAgICAoaW5zdHJ1Y3Rpb24pID0+IHtcbiAgICAgICAgaWYgKGluc3RydWN0aW9uLmFjY291bnRJbmRpY2VzICE9PSB2b2lkIDAgJiYgaW5zdHJ1Y3Rpb24uZGF0YSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4uaW5zdHJ1Y3Rpb24sXG4gICAgICAgICAgYWNjb3VudEluZGljZXM6IGluc3RydWN0aW9uLmFjY291bnRJbmRpY2VzID8/IFtdLFxuICAgICAgICAgIGRhdGE6IGluc3RydWN0aW9uLmRhdGEgPz8gbmV3IFVpbnQ4QXJyYXkoMClcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICApO1xuICB9XG4gIHJldHVybiBtZW1vaXplZEdldEluc3RydWN0aW9uRW5jb2Rlcjtcbn1cbnZhciBtZW1vaXplZEdldEluc3RydWN0aW9uRGVjb2RlcjtcbmZ1bmN0aW9uIGdldEluc3RydWN0aW9uRGVjb2RlcigpIHtcbiAgaWYgKCFtZW1vaXplZEdldEluc3RydWN0aW9uRGVjb2Rlcikge1xuICAgIG1lbW9pemVkR2V0SW5zdHJ1Y3Rpb25EZWNvZGVyID0gdHJhbnNmb3JtRGVjb2RlcihcbiAgICAgIGdldFN0cnVjdERlY29kZXIoW1xuICAgICAgICBbXCJwcm9ncmFtQWRkcmVzc0luZGV4XCIsIGdldFU4RGVjb2RlcigpXSxcbiAgICAgICAgW1wiYWNjb3VudEluZGljZXNcIiwgZ2V0QXJyYXlEZWNvZGVyKGdldFU4RGVjb2RlcigpLCB7IHNpemU6IGdldFNob3J0VTE2RGVjb2RlcigpIH0pXSxcbiAgICAgICAgW1xuICAgICAgICAgIFwiZGF0YVwiLFxuICAgICAgICAgIGFkZERlY29kZXJTaXplUHJlZml4KGdldEJ5dGVzRGVjb2RlcigpLCBnZXRTaG9ydFUxNkRlY29kZXIoKSlcbiAgICAgICAgXVxuICAgICAgXSksXG4gICAgICAvLyBDb252ZXJ0IGFuIGluc3RydWN0aW9uIHRvIGV4Y2x1ZGUgb3B0aW9uYWwgZmllbGRzIGlmIHRoZXkgYXJlIGVtcHR5XG4gICAgICAoaW5zdHJ1Y3Rpb24pID0+IHtcbiAgICAgICAgaWYgKGluc3RydWN0aW9uLmFjY291bnRJbmRpY2VzLmxlbmd0aCAmJiBpbnN0cnVjdGlvbi5kYXRhLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBhY2NvdW50SW5kaWNlcywgZGF0YSwgLi4ucmVzdCB9ID0gaW5zdHJ1Y3Rpb247XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmVzdCxcbiAgICAgICAgICAuLi5hY2NvdW50SW5kaWNlcy5sZW5ndGggPyB7IGFjY291bnRJbmRpY2VzIH0gOiBudWxsLFxuICAgICAgICAgIC4uLmRhdGEuYnl0ZUxlbmd0aCA/IHsgZGF0YSB9IDogbnVsbFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICk7XG4gIH1cbiAgcmV0dXJuIG1lbW9pemVkR2V0SW5zdHJ1Y3Rpb25EZWNvZGVyO1xufVxudmFyIFZFUlNJT05fRkxBR19NQVNLID0gMTI4O1xuZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25WZXJzaW9uRW5jb2RlcigpIHtcbiAgcmV0dXJuIGNyZWF0ZUVuY29kZXIoe1xuICAgIGdldFNpemVGcm9tVmFsdWU6ICh2YWx1ZSkgPT4gdmFsdWUgPT09IFwibGVnYWN5XCIgPyAwIDogMSxcbiAgICBtYXhTaXplOiAxLFxuICAgIHdyaXRlOiAodmFsdWUsIGJ5dGVzLCBvZmZzZXQpID0+IHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gXCJsZWdhY3lcIikge1xuICAgICAgICByZXR1cm4gb2Zmc2V0O1xuICAgICAgfVxuICAgICAgaWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+IDEyNykge1xuICAgICAgICB0aHJvdyBuZXcgU29sYW5hRXJyb3IoU09MQU5BX0VSUk9SX19UUkFOU0FDVElPTl9fVkVSU0lPTl9OVU1CRVJfT1VUX09GX1JBTkdFLCB7XG4gICAgICAgICAgYWN0dWFsVmVyc2lvbjogdmFsdWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBieXRlcy5zZXQoW3ZhbHVlIHwgVkVSU0lPTl9GTEFHX01BU0tdLCBvZmZzZXQpO1xuICAgICAgcmV0dXJuIG9mZnNldCArIDE7XG4gICAgfVxuICB9KTtcbn1cbmZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uVmVyc2lvbkRlY29kZXIoKSB7XG4gIHJldHVybiBjcmVhdGVEZWNvZGVyKHtcbiAgICBtYXhTaXplOiAxLFxuICAgIHJlYWQ6IChieXRlcywgb2Zmc2V0KSA9PiB7XG4gICAgICBjb25zdCBmaXJzdEJ5dGUgPSBieXRlc1tvZmZzZXRdO1xuICAgICAgaWYgKChmaXJzdEJ5dGUgJiBWRVJTSU9OX0ZMQUdfTUFTSykgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIFtcImxlZ2FjeVwiLCBvZmZzZXRdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdmVyc2lvbiA9IGZpcnN0Qnl0ZSBeIFZFUlNJT05fRkxBR19NQVNLO1xuICAgICAgICByZXR1cm4gW3ZlcnNpb24sIG9mZnNldCArIDFdO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5mdW5jdGlvbiBnZXRUcmFuc2FjdGlvblZlcnNpb25Db2RlYygpIHtcbiAgcmV0dXJuIGNvbWJpbmVDb2RlYyhnZXRUcmFuc2FjdGlvblZlcnNpb25FbmNvZGVyKCksIGdldFRyYW5zYWN0aW9uVmVyc2lvbkRlY29kZXIoKSk7XG59XG5cbi8vIHNyYy9jb2RlY3MvbWVzc2FnZS50c1xuZnVuY3Rpb24gZ2V0Q29tcGlsZWRNZXNzYWdlTGVnYWN5RW5jb2RlcigpIHtcbiAgcmV0dXJuIGdldFN0cnVjdEVuY29kZXIoZ2V0UHJlbHVkZVN0cnVjdEVuY29kZXJUdXBsZSgpKTtcbn1cbmZ1bmN0aW9uIGdldENvbXBpbGVkTWVzc2FnZVZlcnNpb25lZEVuY29kZXIoKSB7XG4gIHJldHVybiB0cmFuc2Zvcm1FbmNvZGVyKFxuICAgIGdldFN0cnVjdEVuY29kZXIoW1xuICAgICAgLi4uZ2V0UHJlbHVkZVN0cnVjdEVuY29kZXJUdXBsZSgpLFxuICAgICAgW1wiYWRkcmVzc1RhYmxlTG9va3Vwc1wiLCBnZXRBZGRyZXNzVGFibGVMb29rdXBBcnJheUVuY29kZXIoKV1cbiAgICBdKSxcbiAgICAodmFsdWUpID0+IHtcbiAgICAgIGlmICh2YWx1ZS52ZXJzaW9uID09PSBcImxlZ2FjeVwiKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnZhbHVlLFxuICAgICAgICBhZGRyZXNzVGFibGVMb29rdXBzOiB2YWx1ZS5hZGRyZXNzVGFibGVMb29rdXBzID8/IFtdXG4gICAgICB9O1xuICAgIH1cbiAgKTtcbn1cbmZ1bmN0aW9uIGdldFByZWx1ZGVTdHJ1Y3RFbmNvZGVyVHVwbGUoKSB7XG4gIGNvbnN0IGxpZmV0aW1lVG9rZW5FbmNvZGVyID0gZ2V0VW5pb25FbmNvZGVyKFxuICAgIFtcbiAgICAgIC8vIFVzZSBhIDMyLWJ5dGUgY29uc3RhbnQgZW5jb2RlciBmb3IgYSBtaXNzaW5nIGxpZmV0aW1lIHRva2VuIChpbmRleCAwKS5cbiAgICAgIGdldENvbnN0YW50RW5jb2RlcihuZXcgVWludDhBcnJheSgzMikpLFxuICAgICAgLy8gVXNlIGEgMzItYnl0ZSBiYXNlNTggZW5jb2RlciBmb3IgYSB2YWxpZCBsaWZldGltZSB0b2tlbiAoaW5kZXggMSkuXG4gICAgICBmaXhFbmNvZGVyU2l6ZShnZXRCYXNlNThFbmNvZGVyKCksIDMyKVxuICAgIF0sXG4gICAgKHZhbHVlKSA9PiB2YWx1ZSA9PT0gdm9pZCAwID8gMCA6IDFcbiAgKTtcbiAgcmV0dXJuIFtcbiAgICBbXCJ2ZXJzaW9uXCIsIGdldFRyYW5zYWN0aW9uVmVyc2lvbkVuY29kZXIoKV0sXG4gICAgW1wiaGVhZGVyXCIsIGdldE1lc3NhZ2VIZWFkZXJFbmNvZGVyKCldLFxuICAgIFtcInN0YXRpY0FjY291bnRzXCIsIGdldEFycmF5RW5jb2RlcihnZXRBZGRyZXNzRW5jb2RlcigpLCB7IHNpemU6IGdldFNob3J0VTE2RW5jb2RlcigpIH0pXSxcbiAgICBbXCJsaWZldGltZVRva2VuXCIsIGxpZmV0aW1lVG9rZW5FbmNvZGVyXSxcbiAgICBbXCJpbnN0cnVjdGlvbnNcIiwgZ2V0QXJyYXlFbmNvZGVyKGdldEluc3RydWN0aW9uRW5jb2RlcigpLCB7IHNpemU6IGdldFNob3J0VTE2RW5jb2RlcigpIH0pXVxuICBdO1xufVxuZnVuY3Rpb24gZ2V0UHJlbHVkZVN0cnVjdERlY29kZXJUdXBsZSgpIHtcbiAgcmV0dXJuIFtcbiAgICBbXCJ2ZXJzaW9uXCIsIGdldFRyYW5zYWN0aW9uVmVyc2lvbkRlY29kZXIoKV0sXG4gICAgW1wiaGVhZGVyXCIsIGdldE1lc3NhZ2VIZWFkZXJEZWNvZGVyKCldLFxuICAgIFtcInN0YXRpY0FjY291bnRzXCIsIGdldEFycmF5RGVjb2RlcihnZXRBZGRyZXNzRGVjb2RlcigpLCB7IHNpemU6IGdldFNob3J0VTE2RGVjb2RlcigpIH0pXSxcbiAgICBbXCJsaWZldGltZVRva2VuXCIsIGZpeERlY29kZXJTaXplKGdldEJhc2U1OERlY29kZXIoKSwgMzIpXSxcbiAgICBbXCJpbnN0cnVjdGlvbnNcIiwgZ2V0QXJyYXlEZWNvZGVyKGdldEluc3RydWN0aW9uRGVjb2RlcigpLCB7IHNpemU6IGdldFNob3J0VTE2RGVjb2RlcigpIH0pXSxcbiAgICBbXCJhZGRyZXNzVGFibGVMb29rdXBzXCIsIGdldEFkZHJlc3NUYWJsZUxvb2t1cEFycmF5RGVjb2RlcigpXVxuICBdO1xufVxuZnVuY3Rpb24gZ2V0QWRkcmVzc1RhYmxlTG9va3VwQXJyYXlFbmNvZGVyKCkge1xuICByZXR1cm4gZ2V0QXJyYXlFbmNvZGVyKGdldEFkZHJlc3NUYWJsZUxvb2t1cEVuY29kZXIoKSwgeyBzaXplOiBnZXRTaG9ydFUxNkVuY29kZXIoKSB9KTtcbn1cbmZ1bmN0aW9uIGdldEFkZHJlc3NUYWJsZUxvb2t1cEFycmF5RGVjb2RlcigpIHtcbiAgcmV0dXJuIGdldEFycmF5RGVjb2RlcihnZXRBZGRyZXNzVGFibGVMb29rdXBEZWNvZGVyKCksIHsgc2l6ZTogZ2V0U2hvcnRVMTZEZWNvZGVyKCkgfSk7XG59XG5mdW5jdGlvbiBnZXRDb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZUVuY29kZXIoKSB7XG4gIHJldHVybiBjcmVhdGVFbmNvZGVyKHtcbiAgICBnZXRTaXplRnJvbVZhbHVlOiAoY29tcGlsZWRNZXNzYWdlKSA9PiB7XG4gICAgICBpZiAoY29tcGlsZWRNZXNzYWdlLnZlcnNpb24gPT09IFwibGVnYWN5XCIpIHtcbiAgICAgICAgcmV0dXJuIGdldENvbXBpbGVkTWVzc2FnZUxlZ2FjeUVuY29kZXIoKS5nZXRTaXplRnJvbVZhbHVlKGNvbXBpbGVkTWVzc2FnZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZ2V0Q29tcGlsZWRNZXNzYWdlVmVyc2lvbmVkRW5jb2RlcigpLmdldFNpemVGcm9tVmFsdWUoY29tcGlsZWRNZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHdyaXRlOiAoY29tcGlsZWRNZXNzYWdlLCBieXRlcywgb2Zmc2V0KSA9PiB7XG4gICAgICBpZiAoY29tcGlsZWRNZXNzYWdlLnZlcnNpb24gPT09IFwibGVnYWN5XCIpIHtcbiAgICAgICAgcmV0dXJuIGdldENvbXBpbGVkTWVzc2FnZUxlZ2FjeUVuY29kZXIoKS53cml0ZShjb21waWxlZE1lc3NhZ2UsIGJ5dGVzLCBvZmZzZXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGdldENvbXBpbGVkTWVzc2FnZVZlcnNpb25lZEVuY29kZXIoKS53cml0ZShjb21waWxlZE1lc3NhZ2UsIGJ5dGVzLCBvZmZzZXQpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5mdW5jdGlvbiBnZXRDb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZURlY29kZXIoKSB7XG4gIHJldHVybiB0cmFuc2Zvcm1EZWNvZGVyKFxuICAgIGdldFN0cnVjdERlY29kZXIoZ2V0UHJlbHVkZVN0cnVjdERlY29kZXJUdXBsZSgpKSxcbiAgICAoeyBhZGRyZXNzVGFibGVMb29rdXBzLCAuLi5yZXN0T2ZNZXNzYWdlIH0pID0+IHtcbiAgICAgIGlmIChyZXN0T2ZNZXNzYWdlLnZlcnNpb24gPT09IFwibGVnYWN5XCIgfHwgIWFkZHJlc3NUYWJsZUxvb2t1cHM/Lmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gcmVzdE9mTWVzc2FnZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7IC4uLnJlc3RPZk1lc3NhZ2UsIGFkZHJlc3NUYWJsZUxvb2t1cHMgfTtcbiAgICB9XG4gICk7XG59XG5mdW5jdGlvbiBnZXRDb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZUNvZGVjKCkge1xuICByZXR1cm4gY29tYmluZUNvZGVjKGdldENvbXBpbGVkVHJhbnNhY3Rpb25NZXNzYWdlRW5jb2RlcigpLCBnZXRDb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZURlY29kZXIoKSk7XG59XG5mdW5jdGlvbiB1cHNlcnQoYWRkcmVzc01hcCwgYWRkcmVzcywgdXBkYXRlKSB7XG4gIGFkZHJlc3NNYXBbYWRkcmVzc10gPSB1cGRhdGUoYWRkcmVzc01hcFthZGRyZXNzXSA/PyB7IHJvbGU6IEFjY291bnRSb2xlLlJFQURPTkxZIH0pO1xufVxudmFyIFRZUEUgPSBTeW1ib2woXCJBZGRyZXNzTWFwVHlwZVByb3BlcnR5XCIpO1xuZnVuY3Rpb24gZ2V0QWRkcmVzc01hcEZyb21JbnN0cnVjdGlvbnMoZmVlUGF5ZXIsIGluc3RydWN0aW9ucykge1xuICBjb25zdCBhZGRyZXNzTWFwID0ge1xuICAgIFtmZWVQYXllcl06IHsgW1RZUEVdOiAwIC8qIEZFRV9QQVlFUiAqLywgcm9sZTogQWNjb3VudFJvbGUuV1JJVEFCTEVfU0lHTkVSIH1cbiAgfTtcbiAgY29uc3QgYWRkcmVzc2VzT2ZJbnZva2VkUHJvZ3JhbXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBmb3IgKGNvbnN0IGluc3RydWN0aW9uIG9mIGluc3RydWN0aW9ucykge1xuICAgIHVwc2VydChhZGRyZXNzTWFwLCBpbnN0cnVjdGlvbi5wcm9ncmFtQWRkcmVzcywgKGVudHJ5KSA9PiB7XG4gICAgICBhZGRyZXNzZXNPZkludm9rZWRQcm9ncmFtcy5hZGQoaW5zdHJ1Y3Rpb24ucHJvZ3JhbUFkZHJlc3MpO1xuICAgICAgaWYgKFRZUEUgaW4gZW50cnkpIHtcbiAgICAgICAgaWYgKGlzV3JpdGFibGVSb2xlKGVudHJ5LnJvbGUpKSB7XG4gICAgICAgICAgc3dpdGNoIChlbnRyeVtUWVBFXSkge1xuICAgICAgICAgICAgY2FzZSAwIC8qIEZFRV9QQVlFUiAqLzpcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IFNvbGFuYUVycm9yKFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX0lOVk9LRURfUFJPR1JBTVNfQ0FOTk9UX1BBWV9GRUVTLCB7XG4gICAgICAgICAgICAgICAgcHJvZ3JhbUFkZHJlc3M6IGluc3RydWN0aW9uLnByb2dyYW1BZGRyZXNzXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IFNvbGFuYUVycm9yKFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX0lOVk9LRURfUFJPR1JBTVNfTVVTVF9OT1RfQkVfV1JJVEFCTEUsIHtcbiAgICAgICAgICAgICAgICBwcm9ncmFtQWRkcmVzczogaW5zdHJ1Y3Rpb24ucHJvZ3JhbUFkZHJlc3NcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlbnRyeVtUWVBFXSA9PT0gMiAvKiBTVEFUSUMgKi8pIHtcbiAgICAgICAgICByZXR1cm4gZW50cnk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB7IFtUWVBFXTogMiAvKiBTVEFUSUMgKi8sIHJvbGU6IEFjY291bnRSb2xlLlJFQURPTkxZIH07XG4gICAgfSk7XG4gICAgbGV0IGFkZHJlc3NDb21wYXJhdG9yO1xuICAgIGlmICghaW5zdHJ1Y3Rpb24uYWNjb3VudHMpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGFjY291bnQgb2YgaW5zdHJ1Y3Rpb24uYWNjb3VudHMpIHtcbiAgICAgIHVwc2VydChhZGRyZXNzTWFwLCBhY2NvdW50LmFkZHJlc3MsIChlbnRyeSkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgICAgICAgIGFkZHJlc3M6IF8sXG4gICAgICAgICAgLi4uYWNjb3VudE1ldGFcbiAgICAgICAgfSA9IGFjY291bnQ7XG4gICAgICAgIGlmIChUWVBFIGluIGVudHJ5KSB7XG4gICAgICAgICAgc3dpdGNoIChlbnRyeVtUWVBFXSkge1xuICAgICAgICAgICAgY2FzZSAwIC8qIEZFRV9QQVlFUiAqLzpcbiAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5O1xuICAgICAgICAgICAgY2FzZSAxIC8qIExPT0tVUF9UQUJMRSAqLzoge1xuICAgICAgICAgICAgICBjb25zdCBuZXh0Um9sZSA9IG1lcmdlUm9sZXMoZW50cnkucm9sZSwgYWNjb3VudE1ldGEucm9sZSk7XG4gICAgICAgICAgICAgIGlmIChcImxvb2t1cFRhYmxlQWRkcmVzc1wiIGluIGFjY291bnRNZXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkUmVwbGFjZUVudHJ5ID0gKFxuICAgICAgICAgICAgICAgICAgLy8gQ29uc2lkZXIgdXNpbmcgdGhlIG5ldyBMT09LVVBfVEFCTEUgaWYgaXRzIGFkZHJlc3MgaXMgZGlmZmVyZW50Li4uXG4gICAgICAgICAgICAgICAgICBlbnRyeS5sb29rdXBUYWJsZUFkZHJlc3MgIT09IGFjY291bnRNZXRhLmxvb2t1cFRhYmxlQWRkcmVzcyAmJiAvLyAuLi5hbmQgc29ydHMgYmVmb3JlIHRoZSBleGlzdGluZyBvbmUuXG4gICAgICAgICAgICAgICAgICAoYWRkcmVzc0NvbXBhcmF0b3IgfHw9IGdldEFkZHJlc3NDb21wYXJhdG9yKCkpKFxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50TWV0YS5sb29rdXBUYWJsZUFkZHJlc3MsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5Lmxvb2t1cFRhYmxlQWRkcmVzc1xuICAgICAgICAgICAgICAgICAgKSA8IDBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmIChzaG91bGRSZXBsYWNlRW50cnkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIFtUWVBFXTogMSAvKiBMT09LVVBfVEFCTEUgKi8sXG4gICAgICAgICAgICAgICAgICAgIC4uLmFjY291bnRNZXRhLFxuICAgICAgICAgICAgICAgICAgICByb2xlOiBuZXh0Um9sZVxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNTaWduZXJSb2xlKGFjY291bnRNZXRhLnJvbGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIFtUWVBFXTogMiAvKiBTVEFUSUMgKi8sXG4gICAgICAgICAgICAgICAgICByb2xlOiBuZXh0Um9sZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGVudHJ5LnJvbGUgIT09IG5leHRSb2xlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIC4uLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgcm9sZTogbmV4dFJvbGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAyIC8qIFNUQVRJQyAqLzoge1xuICAgICAgICAgICAgICBjb25zdCBuZXh0Um9sZSA9IG1lcmdlUm9sZXMoZW50cnkucm9sZSwgYWNjb3VudE1ldGEucm9sZSk7XG4gICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyBhZGRyZXNzIHJlcHJlc2VudHMgYSBwcm9ncmFtIHRoYXQgaXMgaW52b2tlZFxuICAgICAgICAgICAgICAgIC8vIGluIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICAgICAgYWRkcmVzc2VzT2ZJbnZva2VkUHJvZ3JhbXMuaGFzKGFjY291bnQuYWRkcmVzcylcbiAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzV3JpdGFibGVSb2xlKGFjY291bnRNZXRhLnJvbGUpKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU29sYW5hRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgIFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX0lOVk9LRURfUFJPR1JBTVNfTVVTVF9OT1RfQkVfV1JJVEFCTEUsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBwcm9ncmFtQWRkcmVzczogYWNjb3VudC5hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5yb2xlICE9PSBuZXh0Um9sZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgLi4uZW50cnksXG4gICAgICAgICAgICAgICAgICAgIHJvbGU6IG5leHRSb2xlXG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZW50cnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKFwibG9va3VwVGFibGVBZGRyZXNzXCIgaW4gYWNjb3VudE1ldGEgJiYgLy8gU3RhdGljIGFjY291bnRzIGNhbiBiZSAndXBncmFkZWQnIHRvIGxvb2t1cCB0YWJsZSBhY2NvdW50cyBhc1xuICAgICAgICAgICAgICAvLyBsb25nIGFzIHRoZXkgYXJlIG5vdCByZXF1aXJlIHRvIHNpZ24gdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgICAhaXNTaWduZXJSb2xlKGVudHJ5LnJvbGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIC4uLmFjY291bnRNZXRhLFxuICAgICAgICAgICAgICAgICAgW1RZUEVdOiAxIC8qIExPT0tVUF9UQUJMRSAqLyxcbiAgICAgICAgICAgICAgICAgIHJvbGU6IG5leHRSb2xlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkucm9sZSAhPT0gbmV4dFJvbGUpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICByb2xlOiBuZXh0Um9sZVxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJsb29rdXBUYWJsZUFkZHJlc3NcIiBpbiBhY2NvdW50TWV0YSkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5hY2NvdW50TWV0YSxcbiAgICAgICAgICAgIFtUWVBFXTogMSAvKiBMT09LVVBfVEFCTEUgKi9cbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5hY2NvdW50TWV0YSxcbiAgICAgICAgICAgIFtUWVBFXTogMiAvKiBTVEFUSUMgKi9cbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGFkZHJlc3NNYXA7XG59XG5mdW5jdGlvbiBnZXRPcmRlcmVkQWNjb3VudHNGcm9tQWRkcmVzc01hcChhZGRyZXNzTWFwKSB7XG4gIGxldCBhZGRyZXNzQ29tcGFyYXRvcjtcbiAgY29uc3Qgb3JkZXJlZEFjY291bnRzID0gT2JqZWN0LmVudHJpZXMoYWRkcmVzc01hcCkuc29ydCgoW2xlZnRBZGRyZXNzLCBsZWZ0RW50cnldLCBbcmlnaHRBZGRyZXNzLCByaWdodEVudHJ5XSkgPT4ge1xuICAgIGlmIChsZWZ0RW50cnlbVFlQRV0gIT09IHJpZ2h0RW50cnlbVFlQRV0pIHtcbiAgICAgIGlmIChsZWZ0RW50cnlbVFlQRV0gPT09IDAgLyogRkVFX1BBWUVSICovKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH0gZWxzZSBpZiAocmlnaHRFbnRyeVtUWVBFXSA9PT0gMCAvKiBGRUVfUEFZRVIgKi8pIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9IGVsc2UgaWYgKGxlZnRFbnRyeVtUWVBFXSA9PT0gMiAvKiBTVEFUSUMgKi8pIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfSBlbHNlIGlmIChyaWdodEVudHJ5W1RZUEVdID09PSAyIC8qIFNUQVRJQyAqLykge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgbGVmdElzU2lnbmVyID0gaXNTaWduZXJSb2xlKGxlZnRFbnRyeS5yb2xlKTtcbiAgICBpZiAobGVmdElzU2lnbmVyICE9PSBpc1NpZ25lclJvbGUocmlnaHRFbnRyeS5yb2xlKSkge1xuICAgICAgcmV0dXJuIGxlZnRJc1NpZ25lciA/IC0xIDogMTtcbiAgICB9XG4gICAgY29uc3QgbGVmdElzV3JpdGFibGUgPSBpc1dyaXRhYmxlUm9sZShsZWZ0RW50cnkucm9sZSk7XG4gICAgaWYgKGxlZnRJc1dyaXRhYmxlICE9PSBpc1dyaXRhYmxlUm9sZShyaWdodEVudHJ5LnJvbGUpKSB7XG4gICAgICByZXR1cm4gbGVmdElzV3JpdGFibGUgPyAtMSA6IDE7XG4gICAgfVxuICAgIGFkZHJlc3NDb21wYXJhdG9yIHx8PSBnZXRBZGRyZXNzQ29tcGFyYXRvcigpO1xuICAgIGlmIChsZWZ0RW50cnlbVFlQRV0gPT09IDEgLyogTE9PS1VQX1RBQkxFICovICYmIHJpZ2h0RW50cnlbVFlQRV0gPT09IDEgLyogTE9PS1VQX1RBQkxFICovICYmIGxlZnRFbnRyeS5sb29rdXBUYWJsZUFkZHJlc3MgIT09IHJpZ2h0RW50cnkubG9va3VwVGFibGVBZGRyZXNzKSB7XG4gICAgICByZXR1cm4gYWRkcmVzc0NvbXBhcmF0b3IobGVmdEVudHJ5Lmxvb2t1cFRhYmxlQWRkcmVzcywgcmlnaHRFbnRyeS5sb29rdXBUYWJsZUFkZHJlc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYWRkcmVzc0NvbXBhcmF0b3IobGVmdEFkZHJlc3MsIHJpZ2h0QWRkcmVzcyk7XG4gICAgfVxuICB9KS5tYXAoKFthZGRyZXNzLCBhZGRyZXNzTWV0YV0pID0+ICh7XG4gICAgYWRkcmVzcyxcbiAgICAuLi5hZGRyZXNzTWV0YVxuICB9KSk7XG4gIHJldHVybiBvcmRlcmVkQWNjb3VudHM7XG59XG5mdW5jdGlvbiBnZXRDb21waWxlZEFkZHJlc3NUYWJsZUxvb2t1cHMob3JkZXJlZEFjY291bnRzKSB7XG4gIGNvbnN0IGluZGV4ID0ge307XG4gIGZvciAoY29uc3QgYWNjb3VudCBvZiBvcmRlcmVkQWNjb3VudHMpIHtcbiAgICBpZiAoIShcImxvb2t1cFRhYmxlQWRkcmVzc1wiIGluIGFjY291bnQpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgZW50cnkgPSBpbmRleFthY2NvdW50Lmxvb2t1cFRhYmxlQWRkcmVzc10gfHw9IHtcbiAgICAgIHJlYWRvbmx5SW5kZXhlczogW10sXG4gICAgICB3cml0YWJsZUluZGV4ZXM6IFtdXG4gICAgfTtcbiAgICBpZiAoYWNjb3VudC5yb2xlID09PSBBY2NvdW50Um9sZS5XUklUQUJMRSkge1xuICAgICAgZW50cnkud3JpdGFibGVJbmRleGVzLnB1c2goYWNjb3VudC5hZGRyZXNzSW5kZXgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbnRyeS5yZWFkb25seUluZGV4ZXMucHVzaChhY2NvdW50LmFkZHJlc3NJbmRleCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBPYmplY3Qua2V5cyhpbmRleCkuc29ydChnZXRBZGRyZXNzQ29tcGFyYXRvcigpKS5tYXAoKGxvb2t1cFRhYmxlQWRkcmVzcykgPT4gKHtcbiAgICBsb29rdXBUYWJsZUFkZHJlc3MsXG4gICAgLi4uaW5kZXhbbG9va3VwVGFibGVBZGRyZXNzXVxuICB9KSk7XG59XG5mdW5jdGlvbiBnZXRDb21waWxlZE1lc3NhZ2VIZWFkZXIob3JkZXJlZEFjY291bnRzKSB7XG4gIGxldCBudW1SZWFkb25seU5vblNpZ25lckFjY291bnRzID0gMDtcbiAgbGV0IG51bVJlYWRvbmx5U2lnbmVyQWNjb3VudHMgPSAwO1xuICBsZXQgbnVtU2lnbmVyQWNjb3VudHMgPSAwO1xuICBmb3IgKGNvbnN0IGFjY291bnQgb2Ygb3JkZXJlZEFjY291bnRzKSB7XG4gICAgaWYgKFwibG9va3VwVGFibGVBZGRyZXNzXCIgaW4gYWNjb3VudCkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRJc1dyaXRhYmxlID0gaXNXcml0YWJsZVJvbGUoYWNjb3VudC5yb2xlKTtcbiAgICBpZiAoaXNTaWduZXJSb2xlKGFjY291bnQucm9sZSkpIHtcbiAgICAgIG51bVNpZ25lckFjY291bnRzKys7XG4gICAgICBpZiAoIWFjY291bnRJc1dyaXRhYmxlKSB7XG4gICAgICAgIG51bVJlYWRvbmx5U2lnbmVyQWNjb3VudHMrKztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFhY2NvdW50SXNXcml0YWJsZSkge1xuICAgICAgbnVtUmVhZG9ubHlOb25TaWduZXJBY2NvdW50cysrO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIG51bVJlYWRvbmx5Tm9uU2lnbmVyQWNjb3VudHMsXG4gICAgbnVtUmVhZG9ubHlTaWduZXJBY2NvdW50cyxcbiAgICBudW1TaWduZXJBY2NvdW50c1xuICB9O1xufVxuXG4vLyBzcmMvY29tcGlsZS9pbnN0cnVjdGlvbnMudHNcbmZ1bmN0aW9uIGdldEFjY291bnRJbmRleChvcmRlcmVkQWNjb3VudHMpIHtcbiAgY29uc3Qgb3V0ID0ge307XG4gIGZvciAoY29uc3QgW2luZGV4LCBhY2NvdW50XSBvZiBvcmRlcmVkQWNjb3VudHMuZW50cmllcygpKSB7XG4gICAgb3V0W2FjY291bnQuYWRkcmVzc10gPSBpbmRleDtcbiAgfVxuICByZXR1cm4gb3V0O1xufVxuZnVuY3Rpb24gZ2V0Q29tcGlsZWRJbnN0cnVjdGlvbnMoaW5zdHJ1Y3Rpb25zLCBvcmRlcmVkQWNjb3VudHMpIHtcbiAgY29uc3QgYWNjb3VudEluZGV4ID0gZ2V0QWNjb3VudEluZGV4KG9yZGVyZWRBY2NvdW50cyk7XG4gIHJldHVybiBpbnN0cnVjdGlvbnMubWFwKCh7IGFjY291bnRzLCBkYXRhLCBwcm9ncmFtQWRkcmVzcyB9KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByb2dyYW1BZGRyZXNzSW5kZXg6IGFjY291bnRJbmRleFtwcm9ncmFtQWRkcmVzc10sXG4gICAgICAuLi5hY2NvdW50cyA/IHsgYWNjb3VudEluZGljZXM6IGFjY291bnRzLm1hcCgoeyBhZGRyZXNzIH0pID0+IGFjY291bnRJbmRleFthZGRyZXNzXSkgfSA6IG51bGwsXG4gICAgICAuLi5kYXRhID8geyBkYXRhIH0gOiBudWxsXG4gICAgfTtcbiAgfSk7XG59XG5cbi8vIHNyYy9jb21waWxlL2xpZmV0aW1lLXRva2VuLnRzXG5mdW5jdGlvbiBnZXRDb21waWxlZExpZmV0aW1lVG9rZW4obGlmZXRpbWVDb25zdHJhaW50KSB7XG4gIGlmIChcIm5vbmNlXCIgaW4gbGlmZXRpbWVDb25zdHJhaW50KSB7XG4gICAgcmV0dXJuIGxpZmV0aW1lQ29uc3RyYWludC5ub25jZTtcbiAgfVxuICByZXR1cm4gbGlmZXRpbWVDb25zdHJhaW50LmJsb2NraGFzaDtcbn1cblxuLy8gc3JjL2NvbXBpbGUvc3RhdGljLWFjY291bnRzLnRzXG5mdW5jdGlvbiBnZXRDb21waWxlZFN0YXRpY0FjY291bnRzKG9yZGVyZWRBY2NvdW50cykge1xuICBjb25zdCBmaXJzdExvb2t1cFRhYmxlQWNjb3VudEluZGV4ID0gb3JkZXJlZEFjY291bnRzLmZpbmRJbmRleCgoYWNjb3VudCkgPT4gXCJsb29rdXBUYWJsZUFkZHJlc3NcIiBpbiBhY2NvdW50KTtcbiAgY29uc3Qgb3JkZXJlZFN0YXRpY0FjY291bnRzID0gZmlyc3RMb29rdXBUYWJsZUFjY291bnRJbmRleCA9PT0gLTEgPyBvcmRlcmVkQWNjb3VudHMgOiBvcmRlcmVkQWNjb3VudHMuc2xpY2UoMCwgZmlyc3RMb29rdXBUYWJsZUFjY291bnRJbmRleCk7XG4gIHJldHVybiBvcmRlcmVkU3RhdGljQWNjb3VudHMubWFwKCh7IGFkZHJlc3MgfSkgPT4gYWRkcmVzcyk7XG59XG5cbi8vIHNyYy9jb21waWxlL21lc3NhZ2UudHNcbmZ1bmN0aW9uIGNvbXBpbGVUcmFuc2FjdGlvbk1lc3NhZ2UodHJhbnNhY3Rpb25NZXNzYWdlKSB7XG4gIGNvbnN0IGFkZHJlc3NNYXAgPSBnZXRBZGRyZXNzTWFwRnJvbUluc3RydWN0aW9ucyhcbiAgICB0cmFuc2FjdGlvbk1lc3NhZ2UuZmVlUGF5ZXIuYWRkcmVzcyxcbiAgICB0cmFuc2FjdGlvbk1lc3NhZ2UuaW5zdHJ1Y3Rpb25zXG4gICk7XG4gIGNvbnN0IG9yZGVyZWRBY2NvdW50cyA9IGdldE9yZGVyZWRBY2NvdW50c0Zyb21BZGRyZXNzTWFwKGFkZHJlc3NNYXApO1xuICBjb25zdCBsaWZldGltZUNvbnN0cmFpbnQgPSB0cmFuc2FjdGlvbk1lc3NhZ2UubGlmZXRpbWVDb25zdHJhaW50O1xuICByZXR1cm4ge1xuICAgIC4uLnRyYW5zYWN0aW9uTWVzc2FnZS52ZXJzaW9uICE9PSBcImxlZ2FjeVwiID8geyBhZGRyZXNzVGFibGVMb29rdXBzOiBnZXRDb21waWxlZEFkZHJlc3NUYWJsZUxvb2t1cHMob3JkZXJlZEFjY291bnRzKSB9IDogbnVsbCxcbiAgICAuLi5saWZldGltZUNvbnN0cmFpbnQgPyB7IGxpZmV0aW1lVG9rZW46IGdldENvbXBpbGVkTGlmZXRpbWVUb2tlbihsaWZldGltZUNvbnN0cmFpbnQpIH0gOiBudWxsLFxuICAgIGhlYWRlcjogZ2V0Q29tcGlsZWRNZXNzYWdlSGVhZGVyKG9yZGVyZWRBY2NvdW50cyksXG4gICAgaW5zdHJ1Y3Rpb25zOiBnZXRDb21waWxlZEluc3RydWN0aW9ucyh0cmFuc2FjdGlvbk1lc3NhZ2UuaW5zdHJ1Y3Rpb25zLCBvcmRlcmVkQWNjb3VudHMpLFxuICAgIHN0YXRpY0FjY291bnRzOiBnZXRDb21waWxlZFN0YXRpY0FjY291bnRzKG9yZGVyZWRBY2NvdW50cyksXG4gICAgdmVyc2lvbjogdHJhbnNhY3Rpb25NZXNzYWdlLnZlcnNpb25cbiAgfTtcbn1cbmZ1bmN0aW9uIGZpbmRBZGRyZXNzSW5Mb29rdXBUYWJsZXMoYWRkcmVzcywgcm9sZSwgYWRkcmVzc2VzQnlMb29rdXBUYWJsZUFkZHJlc3MpIHtcbiAgZm9yIChjb25zdCBbbG9va3VwVGFibGVBZGRyZXNzLCBhZGRyZXNzZXNdIG9mIE9iamVjdC5lbnRyaWVzKGFkZHJlc3Nlc0J5TG9va3VwVGFibGVBZGRyZXNzKSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWRkcmVzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYWRkcmVzcyA9PT0gYWRkcmVzc2VzW2ldKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgICBhZGRyZXNzSW5kZXg6IGksXG4gICAgICAgICAgbG9va3VwVGFibGVBZGRyZXNzLFxuICAgICAgICAgIHJvbGVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGNvbXByZXNzVHJhbnNhY3Rpb25NZXNzYWdlVXNpbmdBZGRyZXNzTG9va3VwVGFibGVzKHRyYW5zYWN0aW9uTWVzc2FnZSwgYWRkcmVzc2VzQnlMb29rdXBUYWJsZUFkZHJlc3MpIHtcbiAgY29uc3QgbG9va3VwVGFibGVBZGRyZXNzZXMgPSBuZXcgU2V0KE9iamVjdC52YWx1ZXMoYWRkcmVzc2VzQnlMb29rdXBUYWJsZUFkZHJlc3MpLmZsYXRNYXAoKGEpID0+IGEpKTtcbiAgY29uc3QgbmV3SW5zdHJ1Y3Rpb25zID0gW107XG4gIGxldCB1cGRhdGVkQW55SW5zdHJ1Y3Rpb25zID0gZmFsc2U7XG4gIGZvciAoY29uc3QgaW5zdHJ1Y3Rpb24gb2YgdHJhbnNhY3Rpb25NZXNzYWdlLmluc3RydWN0aW9ucykge1xuICAgIGlmICghaW5zdHJ1Y3Rpb24uYWNjb3VudHMpIHtcbiAgICAgIG5ld0luc3RydWN0aW9ucy5wdXNoKGluc3RydWN0aW9uKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCBuZXdBY2NvdW50cyA9IFtdO1xuICAgIGxldCB1cGRhdGVkQW55QWNjb3VudHMgPSBmYWxzZTtcbiAgICBmb3IgKGNvbnN0IGFjY291bnQgb2YgaW5zdHJ1Y3Rpb24uYWNjb3VudHMpIHtcbiAgICAgIGlmIChcImxvb2t1cFRhYmxlQWRkcmVzc1wiIGluIGFjY291bnQgfHwgIWxvb2t1cFRhYmxlQWRkcmVzc2VzLmhhcyhhY2NvdW50LmFkZHJlc3MpIHx8IGlzU2lnbmVyUm9sZShhY2NvdW50LnJvbGUpKSB7XG4gICAgICAgIG5ld0FjY291bnRzLnB1c2goYWNjb3VudCk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgbG9va3VwTWV0YUFjY291bnQgPSBmaW5kQWRkcmVzc0luTG9va3VwVGFibGVzKFxuICAgICAgICBhY2NvdW50LmFkZHJlc3MsXG4gICAgICAgIGFjY291bnQucm9sZSxcbiAgICAgICAgYWRkcmVzc2VzQnlMb29rdXBUYWJsZUFkZHJlc3NcbiAgICAgICk7XG4gICAgICBuZXdBY2NvdW50cy5wdXNoKE9iamVjdC5mcmVlemUobG9va3VwTWV0YUFjY291bnQpKTtcbiAgICAgIHVwZGF0ZWRBbnlBY2NvdW50cyA9IHRydWU7XG4gICAgICB1cGRhdGVkQW55SW5zdHJ1Y3Rpb25zID0gdHJ1ZTtcbiAgICB9XG4gICAgbmV3SW5zdHJ1Y3Rpb25zLnB1c2goXG4gICAgICBPYmplY3QuZnJlZXplKHVwZGF0ZWRBbnlBY2NvdW50cyA/IHsgLi4uaW5zdHJ1Y3Rpb24sIGFjY291bnRzOiBuZXdBY2NvdW50cyB9IDogaW5zdHJ1Y3Rpb24pXG4gICAgKTtcbiAgfVxuICByZXR1cm4gT2JqZWN0LmZyZWV6ZShcbiAgICB1cGRhdGVkQW55SW5zdHJ1Y3Rpb25zID8geyAuLi50cmFuc2FjdGlvbk1lc3NhZ2UsIGluc3RydWN0aW9uczogbmV3SW5zdHJ1Y3Rpb25zIH0gOiB0cmFuc2FjdGlvbk1lc3NhZ2VcbiAgKTtcbn1cblxuLy8gc3JjL2NyZWF0ZS10cmFuc2FjdGlvbi1tZXNzYWdlLnRzXG5mdW5jdGlvbiBjcmVhdGVUcmFuc2FjdGlvbk1lc3NhZ2UoY29uZmlnKSB7XG4gIHJldHVybiBPYmplY3QuZnJlZXplKHtcbiAgICBpbnN0cnVjdGlvbnM6IE9iamVjdC5mcmVlemUoW10pLFxuICAgIHZlcnNpb246IGNvbmZpZy52ZXJzaW9uXG4gIH0pO1xufVxudmFyIFJFQ0VOVF9CTE9DS0hBU0hFU19TWVNWQVJfQUREUkVTUyA9IFwiU3lzdmFyUmVjZW50QjFvY2tIYXNoZXMxMTExMTExMTExMTExMTExMTExMVwiO1xudmFyIFNZU1RFTV9QUk9HUkFNX0FERFJFU1MgPSBcIjExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExXCI7XG5mdW5jdGlvbiBjcmVhdGVBZHZhbmNlTm9uY2VBY2NvdW50SW5zdHJ1Y3Rpb24obm9uY2VBY2NvdW50QWRkcmVzcywgbm9uY2VBdXRob3JpdHlBZGRyZXNzKSB7XG4gIHJldHVybiB7XG4gICAgYWNjb3VudHM6IFtcbiAgICAgIHsgYWRkcmVzczogbm9uY2VBY2NvdW50QWRkcmVzcywgcm9sZTogQWNjb3VudFJvbGUuV1JJVEFCTEUgfSxcbiAgICAgIHtcbiAgICAgICAgYWRkcmVzczogUkVDRU5UX0JMT0NLSEFTSEVTX1NZU1ZBUl9BRERSRVNTLFxuICAgICAgICByb2xlOiBBY2NvdW50Um9sZS5SRUFET05MWVxuICAgICAgfSxcbiAgICAgIHsgYWRkcmVzczogbm9uY2VBdXRob3JpdHlBZGRyZXNzLCByb2xlOiBBY2NvdW50Um9sZS5SRUFET05MWV9TSUdORVIgfVxuICAgIF0sXG4gICAgZGF0YTogbmV3IFVpbnQ4QXJyYXkoWzQsIDAsIDAsIDBdKSxcbiAgICBwcm9ncmFtQWRkcmVzczogU1lTVEVNX1BST0dSQU1fQUREUkVTU1xuICB9O1xufVxuZnVuY3Rpb24gaXNBZHZhbmNlTm9uY2VBY2NvdW50SW5zdHJ1Y3Rpb24oaW5zdHJ1Y3Rpb24pIHtcbiAgcmV0dXJuIGluc3RydWN0aW9uLnByb2dyYW1BZGRyZXNzID09PSBTWVNURU1fUFJPR1JBTV9BRERSRVNTICYmIC8vIFRlc3QgZm9yIGBBZHZhbmNlTm9uY2VBY2NvdW50YCBpbnN0cnVjdGlvbiBkYXRhXG4gIGluc3RydWN0aW9uLmRhdGEgIT0gbnVsbCAmJiBpc0FkdmFuY2VOb25jZUFjY291bnRJbnN0cnVjdGlvbkRhdGEoaW5zdHJ1Y3Rpb24uZGF0YSkgJiYgLy8gVGVzdCBmb3IgZXhhY3RseSAzIGFjY291bnRzXG4gIGluc3RydWN0aW9uLmFjY291bnRzPy5sZW5ndGggPT09IDMgJiYgLy8gRmlyc3QgYWNjb3VudCBpcyBub25jZSBhY2NvdW50IGFkZHJlc3NcbiAgaW5zdHJ1Y3Rpb24uYWNjb3VudHNbMF0uYWRkcmVzcyAhPSBudWxsICYmIGluc3RydWN0aW9uLmFjY291bnRzWzBdLnJvbGUgPT09IEFjY291bnRSb2xlLldSSVRBQkxFICYmIC8vIFNlY29uZCBhY2NvdW50IGlzIHJlY2VudCBibG9ja2hhc2hlcyBzeXN2YXJcbiAgaW5zdHJ1Y3Rpb24uYWNjb3VudHNbMV0uYWRkcmVzcyA9PT0gUkVDRU5UX0JMT0NLSEFTSEVTX1NZU1ZBUl9BRERSRVNTICYmIGluc3RydWN0aW9uLmFjY291bnRzWzFdLnJvbGUgPT09IEFjY291bnRSb2xlLlJFQURPTkxZICYmIC8vIFRoaXJkIGFjY291bnQgaXMgbm9uY2UgYXV0aG9yaXR5IGFjY291bnRcbiAgaW5zdHJ1Y3Rpb24uYWNjb3VudHNbMl0uYWRkcmVzcyAhPSBudWxsICYmIGlzU2lnbmVyUm9sZShpbnN0cnVjdGlvbi5hY2NvdW50c1syXS5yb2xlKTtcbn1cbmZ1bmN0aW9uIGlzQWR2YW5jZU5vbmNlQWNjb3VudEluc3RydWN0aW9uRGF0YShkYXRhKSB7XG4gIHJldHVybiBkYXRhLmJ5dGVMZW5ndGggPT09IDQgJiYgZGF0YVswXSA9PT0gNCAmJiBkYXRhWzFdID09PSAwICYmIGRhdGFbMl0gPT09IDAgJiYgZGF0YVszXSA9PT0gMDtcbn1cblxuLy8gc3JjL2R1cmFibGUtbm9uY2UudHNcbmZ1bmN0aW9uIGlzVHJhbnNhY3Rpb25NZXNzYWdlV2l0aER1cmFibGVOb25jZUxpZmV0aW1lKHRyYW5zYWN0aW9uTWVzc2FnZSkge1xuICByZXR1cm4gXCJsaWZldGltZUNvbnN0cmFpbnRcIiBpbiB0cmFuc2FjdGlvbk1lc3NhZ2UgJiYgdHlwZW9mIHRyYW5zYWN0aW9uTWVzc2FnZS5saWZldGltZUNvbnN0cmFpbnQubm9uY2UgPT09IFwic3RyaW5nXCIgJiYgdHJhbnNhY3Rpb25NZXNzYWdlLmluc3RydWN0aW9uc1swXSAhPSBudWxsICYmIGlzQWR2YW5jZU5vbmNlQWNjb3VudEluc3RydWN0aW9uKHRyYW5zYWN0aW9uTWVzc2FnZS5pbnN0cnVjdGlvbnNbMF0pO1xufVxuZnVuY3Rpb24gYXNzZXJ0SXNUcmFuc2FjdGlvbk1lc3NhZ2VXaXRoRHVyYWJsZU5vbmNlTGlmZXRpbWUodHJhbnNhY3Rpb25NZXNzYWdlKSB7XG4gIGlmICghaXNUcmFuc2FjdGlvbk1lc3NhZ2VXaXRoRHVyYWJsZU5vbmNlTGlmZXRpbWUodHJhbnNhY3Rpb25NZXNzYWdlKSkge1xuICAgIHRocm93IG5ldyBTb2xhbmFFcnJvcihTT0xBTkFfRVJST1JfX1RSQU5TQUNUSU9OX19FWFBFQ1RFRF9OT05DRV9MSUZFVElNRSk7XG4gIH1cbn1cbmZ1bmN0aW9uIGlzQWR2YW5jZU5vbmNlQWNjb3VudEluc3RydWN0aW9uRm9yTm9uY2UoaW5zdHJ1Y3Rpb24sIG5vbmNlQWNjb3VudEFkZHJlc3MsIG5vbmNlQXV0aG9yaXR5QWRkcmVzcykge1xuICByZXR1cm4gaW5zdHJ1Y3Rpb24uYWNjb3VudHNbMF0uYWRkcmVzcyA9PT0gbm9uY2VBY2NvdW50QWRkcmVzcyAmJiBpbnN0cnVjdGlvbi5hY2NvdW50c1syXS5hZGRyZXNzID09PSBub25jZUF1dGhvcml0eUFkZHJlc3M7XG59XG5mdW5jdGlvbiBzZXRUcmFuc2FjdGlvbk1lc3NhZ2VMaWZldGltZVVzaW5nRHVyYWJsZU5vbmNlKHtcbiAgbm9uY2UsXG4gIG5vbmNlQWNjb3VudEFkZHJlc3MsXG4gIG5vbmNlQXV0aG9yaXR5QWRkcmVzc1xufSwgdHJhbnNhY3Rpb25NZXNzYWdlKSB7XG4gIGxldCBuZXdJbnN0cnVjdGlvbnM7XG4gIGNvbnN0IGZpcnN0SW5zdHJ1Y3Rpb24gPSB0cmFuc2FjdGlvbk1lc3NhZ2UuaW5zdHJ1Y3Rpb25zWzBdO1xuICBpZiAoZmlyc3RJbnN0cnVjdGlvbiAmJiBpc0FkdmFuY2VOb25jZUFjY291bnRJbnN0cnVjdGlvbihmaXJzdEluc3RydWN0aW9uKSkge1xuICAgIGlmIChpc0FkdmFuY2VOb25jZUFjY291bnRJbnN0cnVjdGlvbkZvck5vbmNlKGZpcnN0SW5zdHJ1Y3Rpb24sIG5vbmNlQWNjb3VudEFkZHJlc3MsIG5vbmNlQXV0aG9yaXR5QWRkcmVzcykpIHtcbiAgICAgIGlmIChpc1RyYW5zYWN0aW9uTWVzc2FnZVdpdGhEdXJhYmxlTm9uY2VMaWZldGltZSh0cmFuc2FjdGlvbk1lc3NhZ2UpICYmIHRyYW5zYWN0aW9uTWVzc2FnZS5saWZldGltZUNvbnN0cmFpbnQubm9uY2UgPT09IG5vbmNlKSB7XG4gICAgICAgIHJldHVybiB0cmFuc2FjdGlvbk1lc3NhZ2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdJbnN0cnVjdGlvbnMgPSBbZmlyc3RJbnN0cnVjdGlvbiwgLi4udHJhbnNhY3Rpb25NZXNzYWdlLmluc3RydWN0aW9ucy5zbGljZSgxKV07XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld0luc3RydWN0aW9ucyA9IFtcbiAgICAgICAgT2JqZWN0LmZyZWV6ZShjcmVhdGVBZHZhbmNlTm9uY2VBY2NvdW50SW5zdHJ1Y3Rpb24obm9uY2VBY2NvdW50QWRkcmVzcywgbm9uY2VBdXRob3JpdHlBZGRyZXNzKSksXG4gICAgICAgIC4uLnRyYW5zYWN0aW9uTWVzc2FnZS5pbnN0cnVjdGlvbnMuc2xpY2UoMSlcbiAgICAgIF07XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIG5ld0luc3RydWN0aW9ucyA9IFtcbiAgICAgIE9iamVjdC5mcmVlemUoY3JlYXRlQWR2YW5jZU5vbmNlQWNjb3VudEluc3RydWN0aW9uKG5vbmNlQWNjb3VudEFkZHJlc3MsIG5vbmNlQXV0aG9yaXR5QWRkcmVzcykpLFxuICAgICAgLi4udHJhbnNhY3Rpb25NZXNzYWdlLmluc3RydWN0aW9uc1xuICAgIF07XG4gIH1cbiAgcmV0dXJuIE9iamVjdC5mcmVlemUoe1xuICAgIC4uLnRyYW5zYWN0aW9uTWVzc2FnZSxcbiAgICBpbnN0cnVjdGlvbnM6IE9iamVjdC5mcmVlemUobmV3SW5zdHJ1Y3Rpb25zKSxcbiAgICBsaWZldGltZUNvbnN0cmFpbnQ6IE9iamVjdC5mcmVlemUoeyBub25jZSB9KVxuICB9KTtcbn1cblxuLy8gc3JjL2ZlZS1wYXllci50c1xuZnVuY3Rpb24gc2V0VHJhbnNhY3Rpb25NZXNzYWdlRmVlUGF5ZXIoZmVlUGF5ZXIsIHRyYW5zYWN0aW9uTWVzc2FnZSkge1xuICBpZiAoXCJmZWVQYXllclwiIGluIHRyYW5zYWN0aW9uTWVzc2FnZSAmJiBmZWVQYXllciA9PT0gdHJhbnNhY3Rpb25NZXNzYWdlLmZlZVBheWVyPy5hZGRyZXNzICYmIGlzQWRkcmVzc09ubHlGZWVQYXllcih0cmFuc2FjdGlvbk1lc3NhZ2UuZmVlUGF5ZXIpKSB7XG4gICAgcmV0dXJuIHRyYW5zYWN0aW9uTWVzc2FnZTtcbiAgfVxuICBjb25zdCBvdXQgPSB7XG4gICAgLi4udHJhbnNhY3Rpb25NZXNzYWdlLFxuICAgIGZlZVBheWVyOiBPYmplY3QuZnJlZXplKHsgYWRkcmVzczogZmVlUGF5ZXIgfSlcbiAgfTtcbiAgT2JqZWN0LmZyZWV6ZShvdXQpO1xuICByZXR1cm4gb3V0O1xufVxuZnVuY3Rpb24gaXNBZGRyZXNzT25seUZlZVBheWVyKGZlZVBheWVyKSB7XG4gIHJldHVybiAhIWZlZVBheWVyICYmIFwiYWRkcmVzc1wiIGluIGZlZVBheWVyICYmIHR5cGVvZiBmZWVQYXllci5hZGRyZXNzID09PSBcInN0cmluZ1wiICYmIE9iamVjdC5rZXlzKGZlZVBheWVyKS5sZW5ndGggPT09IDE7XG59XG5cbi8vIHNyYy9pbnN0cnVjdGlvbnMudHNcbmZ1bmN0aW9uIGFwcGVuZFRyYW5zYWN0aW9uTWVzc2FnZUluc3RydWN0aW9uKGluc3RydWN0aW9uLCB0cmFuc2FjdGlvbk1lc3NhZ2UpIHtcbiAgcmV0dXJuIGFwcGVuZFRyYW5zYWN0aW9uTWVzc2FnZUluc3RydWN0aW9ucyhbaW5zdHJ1Y3Rpb25dLCB0cmFuc2FjdGlvbk1lc3NhZ2UpO1xufVxuZnVuY3Rpb24gYXBwZW5kVHJhbnNhY3Rpb25NZXNzYWdlSW5zdHJ1Y3Rpb25zKGluc3RydWN0aW9ucywgdHJhbnNhY3Rpb25NZXNzYWdlKSB7XG4gIHJldHVybiBPYmplY3QuZnJlZXplKHtcbiAgICAuLi50cmFuc2FjdGlvbk1lc3NhZ2UsXG4gICAgaW5zdHJ1Y3Rpb25zOiBPYmplY3QuZnJlZXplKFtcbiAgICAgIC4uLnRyYW5zYWN0aW9uTWVzc2FnZS5pbnN0cnVjdGlvbnMsXG4gICAgICAuLi5pbnN0cnVjdGlvbnNcbiAgICBdKVxuICB9KTtcbn1cbmZ1bmN0aW9uIHByZXBlbmRUcmFuc2FjdGlvbk1lc3NhZ2VJbnN0cnVjdGlvbihpbnN0cnVjdGlvbiwgdHJhbnNhY3Rpb25NZXNzYWdlKSB7XG4gIHJldHVybiBwcmVwZW5kVHJhbnNhY3Rpb25NZXNzYWdlSW5zdHJ1Y3Rpb25zKFtpbnN0cnVjdGlvbl0sIHRyYW5zYWN0aW9uTWVzc2FnZSk7XG59XG5mdW5jdGlvbiBwcmVwZW5kVHJhbnNhY3Rpb25NZXNzYWdlSW5zdHJ1Y3Rpb25zKGluc3RydWN0aW9ucywgdHJhbnNhY3Rpb25NZXNzYWdlKSB7XG4gIHJldHVybiBPYmplY3QuZnJlZXplKHtcbiAgICAuLi50cmFuc2FjdGlvbk1lc3NhZ2UsXG4gICAgaW5zdHJ1Y3Rpb25zOiBPYmplY3QuZnJlZXplKFtcbiAgICAgIC4uLmluc3RydWN0aW9ucyxcbiAgICAgIC4uLnRyYW5zYWN0aW9uTWVzc2FnZS5pbnN0cnVjdGlvbnNcbiAgICBdKVxuICB9KTtcbn1cblxuLy8gc3JjL2RlY29tcGlsZS1tZXNzYWdlLnRzXG5mdW5jdGlvbiBnZXRBY2NvdW50TWV0YXMobWVzc2FnZSkge1xuICBjb25zdCB7IGhlYWRlciB9ID0gbWVzc2FnZTtcbiAgY29uc3QgbnVtV3JpdGFibGVTaWduZXJBY2NvdW50cyA9IGhlYWRlci5udW1TaWduZXJBY2NvdW50cyAtIGhlYWRlci5udW1SZWFkb25seVNpZ25lckFjY291bnRzO1xuICBjb25zdCBudW1Xcml0YWJsZU5vblNpZ25lckFjY291bnRzID0gbWVzc2FnZS5zdGF0aWNBY2NvdW50cy5sZW5ndGggLSBoZWFkZXIubnVtU2lnbmVyQWNjb3VudHMgLSBoZWFkZXIubnVtUmVhZG9ubHlOb25TaWduZXJBY2NvdW50cztcbiAgY29uc3QgYWNjb3VudE1ldGFzID0gW107XG4gIGxldCBhY2NvdW50SW5kZXggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdyaXRhYmxlU2lnbmVyQWNjb3VudHM7IGkrKykge1xuICAgIGFjY291bnRNZXRhcy5wdXNoKHtcbiAgICAgIGFkZHJlc3M6IG1lc3NhZ2Uuc3RhdGljQWNjb3VudHNbYWNjb3VudEluZGV4XSxcbiAgICAgIHJvbGU6IEFjY291bnRSb2xlLldSSVRBQkxFX1NJR05FUlxuICAgIH0pO1xuICAgIGFjY291bnRJbmRleCsrO1xuICB9XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaGVhZGVyLm51bVJlYWRvbmx5U2lnbmVyQWNjb3VudHM7IGkrKykge1xuICAgIGFjY291bnRNZXRhcy5wdXNoKHtcbiAgICAgIGFkZHJlc3M6IG1lc3NhZ2Uuc3RhdGljQWNjb3VudHNbYWNjb3VudEluZGV4XSxcbiAgICAgIHJvbGU6IEFjY291bnRSb2xlLlJFQURPTkxZX1NJR05FUlxuICAgIH0pO1xuICAgIGFjY291bnRJbmRleCsrO1xuICB9XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV3JpdGFibGVOb25TaWduZXJBY2NvdW50czsgaSsrKSB7XG4gICAgYWNjb3VudE1ldGFzLnB1c2goe1xuICAgICAgYWRkcmVzczogbWVzc2FnZS5zdGF0aWNBY2NvdW50c1thY2NvdW50SW5kZXhdLFxuICAgICAgcm9sZTogQWNjb3VudFJvbGUuV1JJVEFCTEVcbiAgICB9KTtcbiAgICBhY2NvdW50SW5kZXgrKztcbiAgfVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGhlYWRlci5udW1SZWFkb25seU5vblNpZ25lckFjY291bnRzOyBpKyspIHtcbiAgICBhY2NvdW50TWV0YXMucHVzaCh7XG4gICAgICBhZGRyZXNzOiBtZXNzYWdlLnN0YXRpY0FjY291bnRzW2FjY291bnRJbmRleF0sXG4gICAgICByb2xlOiBBY2NvdW50Um9sZS5SRUFET05MWVxuICAgIH0pO1xuICAgIGFjY291bnRJbmRleCsrO1xuICB9XG4gIHJldHVybiBhY2NvdW50TWV0YXM7XG59XG5mdW5jdGlvbiBnZXRBZGRyZXNzTG9va3VwTWV0YXMoY29tcGlsZWRBZGRyZXNzVGFibGVMb29rdXBzLCBhZGRyZXNzZXNCeUxvb2t1cFRhYmxlQWRkcmVzcykge1xuICBjb25zdCBjb21waWxlZEFkZHJlc3NUYWJsZUxvb2t1cEFkZHJlc3NlcyA9IGNvbXBpbGVkQWRkcmVzc1RhYmxlTG9va3Vwcy5tYXAoKGwpID0+IGwubG9va3VwVGFibGVBZGRyZXNzKTtcbiAgY29uc3QgbWlzc2luZyA9IGNvbXBpbGVkQWRkcmVzc1RhYmxlTG9va3VwQWRkcmVzc2VzLmZpbHRlcigoYSkgPT4gYWRkcmVzc2VzQnlMb29rdXBUYWJsZUFkZHJlc3NbYV0gPT09IHZvaWQgMCk7XG4gIGlmIChtaXNzaW5nLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBuZXcgU29sYW5hRXJyb3IoU09MQU5BX0VSUk9SX19UUkFOU0FDVElPTl9fRkFJTEVEX1RPX0RFQ09NUElMRV9BRERSRVNTX0xPT0tVUF9UQUJMRV9DT05URU5UU19NSVNTSU5HLCB7XG4gICAgICBsb29rdXBUYWJsZUFkZHJlc3NlczogbWlzc2luZ1xuICAgIH0pO1xuICB9XG4gIGNvbnN0IHJlYWRPbmx5TWV0YXMgPSBbXTtcbiAgY29uc3Qgd3JpdGFibGVNZXRhcyA9IFtdO1xuICBmb3IgKGNvbnN0IGxvb2t1cCBvZiBjb21waWxlZEFkZHJlc3NUYWJsZUxvb2t1cHMpIHtcbiAgICBjb25zdCBhZGRyZXNzZXMgPSBhZGRyZXNzZXNCeUxvb2t1cFRhYmxlQWRkcmVzc1tsb29rdXAubG9va3VwVGFibGVBZGRyZXNzXTtcbiAgICBjb25zdCByZWFkb25seUluZGV4ZXMgPSBsb29rdXAucmVhZG9ubHlJbmRleGVzO1xuICAgIGNvbnN0IHdyaXRhYmxlSW5kZXhlcyA9IGxvb2t1cC53cml0YWJsZUluZGV4ZXM7XG4gICAgY29uc3QgaGlnaGVzdEluZGV4ID0gTWF0aC5tYXgoLi4ucmVhZG9ubHlJbmRleGVzLCAuLi53cml0YWJsZUluZGV4ZXMpO1xuICAgIGlmIChoaWdoZXN0SW5kZXggPj0gYWRkcmVzc2VzLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IFNvbGFuYUVycm9yKFxuICAgICAgICBTT0xBTkFfRVJST1JfX1RSQU5TQUNUSU9OX19GQUlMRURfVE9fREVDT01QSUxFX0FERFJFU1NfTE9PS1VQX1RBQkxFX0lOREVYX09VVF9PRl9SQU5HRSxcbiAgICAgICAge1xuICAgICAgICAgIGhpZ2hlc3RLbm93bkluZGV4OiBhZGRyZXNzZXMubGVuZ3RoIC0gMSxcbiAgICAgICAgICBoaWdoZXN0UmVxdWVzdGVkSW5kZXg6IGhpZ2hlc3RJbmRleCxcbiAgICAgICAgICBsb29rdXBUYWJsZUFkZHJlc3M6IGxvb2t1cC5sb29rdXBUYWJsZUFkZHJlc3NcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcmVhZE9ubHlGb3JMb29rdXAgPSByZWFkb25seUluZGV4ZXMubWFwKChyKSA9PiAoe1xuICAgICAgYWRkcmVzczogYWRkcmVzc2VzW3JdLFxuICAgICAgYWRkcmVzc0luZGV4OiByLFxuICAgICAgbG9va3VwVGFibGVBZGRyZXNzOiBsb29rdXAubG9va3VwVGFibGVBZGRyZXNzLFxuICAgICAgcm9sZTogQWNjb3VudFJvbGUuUkVBRE9OTFlcbiAgICB9KSk7XG4gICAgcmVhZE9ubHlNZXRhcy5wdXNoKC4uLnJlYWRPbmx5Rm9yTG9va3VwKTtcbiAgICBjb25zdCB3cml0YWJsZUZvckxvb2t1cCA9IHdyaXRhYmxlSW5kZXhlcy5tYXAoKHcpID0+ICh7XG4gICAgICBhZGRyZXNzOiBhZGRyZXNzZXNbd10sXG4gICAgICBhZGRyZXNzSW5kZXg6IHcsXG4gICAgICBsb29rdXBUYWJsZUFkZHJlc3M6IGxvb2t1cC5sb29rdXBUYWJsZUFkZHJlc3MsXG4gICAgICByb2xlOiBBY2NvdW50Um9sZS5XUklUQUJMRVxuICAgIH0pKTtcbiAgICB3cml0YWJsZU1ldGFzLnB1c2goLi4ud3JpdGFibGVGb3JMb29rdXApO1xuICB9XG4gIHJldHVybiBbLi4ud3JpdGFibGVNZXRhcywgLi4ucmVhZE9ubHlNZXRhc107XG59XG5mdW5jdGlvbiBjb252ZXJ0SW5zdHJ1Y3Rpb24oaW5zdHJ1Y3Rpb24sIGFjY291bnRNZXRhcykge1xuICBjb25zdCBwcm9ncmFtQWRkcmVzcyA9IGFjY291bnRNZXRhc1tpbnN0cnVjdGlvbi5wcm9ncmFtQWRkcmVzc0luZGV4XT8uYWRkcmVzcztcbiAgaWYgKCFwcm9ncmFtQWRkcmVzcykge1xuICAgIHRocm93IG5ldyBTb2xhbmFFcnJvcihTT0xBTkFfRVJST1JfX1RSQU5TQUNUSU9OX19GQUlMRURfVE9fREVDT01QSUxFX0lOU1RSVUNUSU9OX1BST0dSQU1fQUREUkVTU19OT1RfRk9VTkQsIHtcbiAgICAgIGluZGV4OiBpbnN0cnVjdGlvbi5wcm9ncmFtQWRkcmVzc0luZGV4XG4gICAgfSk7XG4gIH1cbiAgY29uc3QgYWNjb3VudHMgPSBpbnN0cnVjdGlvbi5hY2NvdW50SW5kaWNlcz8ubWFwKChhY2NvdW50SW5kZXgpID0+IGFjY291bnRNZXRhc1thY2NvdW50SW5kZXhdKTtcbiAgY29uc3QgeyBkYXRhIH0gPSBpbnN0cnVjdGlvbjtcbiAgcmV0dXJuIE9iamVjdC5mcmVlemUoe1xuICAgIHByb2dyYW1BZGRyZXNzLFxuICAgIC4uLmFjY291bnRzICYmIGFjY291bnRzLmxlbmd0aCA/IHsgYWNjb3VudHM6IE9iamVjdC5mcmVlemUoYWNjb3VudHMpIH0gOiB7fSxcbiAgICAuLi5kYXRhICYmIGRhdGEubGVuZ3RoID8geyBkYXRhIH0gOiB7fVxuICB9KTtcbn1cbmZ1bmN0aW9uIGdldExpZmV0aW1lQ29uc3RyYWludChtZXNzYWdlTGlmZXRpbWVUb2tlbiwgZmlyc3RJbnN0cnVjdGlvbiwgbGFzdFZhbGlkQmxvY2tIZWlnaHQpIHtcbiAgaWYgKCFmaXJzdEluc3RydWN0aW9uIHx8ICFpc0FkdmFuY2VOb25jZUFjY291bnRJbnN0cnVjdGlvbihmaXJzdEluc3RydWN0aW9uKSkge1xuICAgIHJldHVybiB7XG4gICAgICBibG9ja2hhc2g6IG1lc3NhZ2VMaWZldGltZVRva2VuLFxuICAgICAgbGFzdFZhbGlkQmxvY2tIZWlnaHQ6IGxhc3RWYWxpZEJsb2NrSGVpZ2h0ID8/IDJuICoqIDY0biAtIDFuXG4gICAgICAvLyBVNjQgTUFYXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBub25jZUFjY291bnRBZGRyZXNzID0gZmlyc3RJbnN0cnVjdGlvbi5hY2NvdW50c1swXS5hZGRyZXNzO1xuICAgIGFzc2VydElzQWRkcmVzcyhub25jZUFjY291bnRBZGRyZXNzKTtcbiAgICBjb25zdCBub25jZUF1dGhvcml0eUFkZHJlc3MgPSBmaXJzdEluc3RydWN0aW9uLmFjY291bnRzWzJdLmFkZHJlc3M7XG4gICAgYXNzZXJ0SXNBZGRyZXNzKG5vbmNlQXV0aG9yaXR5QWRkcmVzcyk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5vbmNlOiBtZXNzYWdlTGlmZXRpbWVUb2tlbixcbiAgICAgIG5vbmNlQWNjb3VudEFkZHJlc3MsXG4gICAgICBub25jZUF1dGhvcml0eUFkZHJlc3NcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBkZWNvbXBpbGVUcmFuc2FjdGlvbk1lc3NhZ2UoY29tcGlsZWRUcmFuc2FjdGlvbk1lc3NhZ2UsIGNvbmZpZykge1xuICBjb25zdCBmZWVQYXllciA9IGNvbXBpbGVkVHJhbnNhY3Rpb25NZXNzYWdlLnN0YXRpY0FjY291bnRzWzBdO1xuICBpZiAoIWZlZVBheWVyKSB7XG4gICAgdGhyb3cgbmV3IFNvbGFuYUVycm9yKFNPTEFOQV9FUlJPUl9fVFJBTlNBQ1RJT05fX0ZBSUxFRF9UT19ERUNPTVBJTEVfRkVFX1BBWUVSX01JU1NJTkcpO1xuICB9XG4gIGNvbnN0IGFjY291bnRNZXRhcyA9IGdldEFjY291bnRNZXRhcyhjb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZSk7XG4gIGNvbnN0IGFjY291bnRMb29rdXBNZXRhcyA9IFwiYWRkcmVzc1RhYmxlTG9va3Vwc1wiIGluIGNvbXBpbGVkVHJhbnNhY3Rpb25NZXNzYWdlICYmIGNvbXBpbGVkVHJhbnNhY3Rpb25NZXNzYWdlLmFkZHJlc3NUYWJsZUxvb2t1cHMgIT09IHZvaWQgMCAmJiBjb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZS5hZGRyZXNzVGFibGVMb29rdXBzLmxlbmd0aCA+IDAgPyBnZXRBZGRyZXNzTG9va3VwTWV0YXMoXG4gICAgY29tcGlsZWRUcmFuc2FjdGlvbk1lc3NhZ2UuYWRkcmVzc1RhYmxlTG9va3VwcyxcbiAgICBjb25maWc/LmFkZHJlc3Nlc0J5TG9va3VwVGFibGVBZGRyZXNzID8/IHt9XG4gICkgOiBbXTtcbiAgY29uc3QgdHJhbnNhY3Rpb25NZXRhcyA9IFsuLi5hY2NvdW50TWV0YXMsIC4uLmFjY291bnRMb29rdXBNZXRhc107XG4gIGNvbnN0IGluc3RydWN0aW9ucyA9IGNvbXBpbGVkVHJhbnNhY3Rpb25NZXNzYWdlLmluc3RydWN0aW9ucy5tYXAoXG4gICAgKGNvbXBpbGVkSW5zdHJ1Y3Rpb24pID0+IGNvbnZlcnRJbnN0cnVjdGlvbihjb21waWxlZEluc3RydWN0aW9uLCB0cmFuc2FjdGlvbk1ldGFzKVxuICApO1xuICBjb25zdCBmaXJzdEluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb25zWzBdO1xuICBjb25zdCBsaWZldGltZUNvbnN0cmFpbnQgPSBnZXRMaWZldGltZUNvbnN0cmFpbnQoXG4gICAgY29tcGlsZWRUcmFuc2FjdGlvbk1lc3NhZ2UubGlmZXRpbWVUb2tlbixcbiAgICBmaXJzdEluc3RydWN0aW9uLFxuICAgIGNvbmZpZz8ubGFzdFZhbGlkQmxvY2tIZWlnaHRcbiAgKTtcbiAgcmV0dXJuIHBpcGUoXG4gICAgY3JlYXRlVHJhbnNhY3Rpb25NZXNzYWdlKHsgdmVyc2lvbjogY29tcGlsZWRUcmFuc2FjdGlvbk1lc3NhZ2UudmVyc2lvbiB9KSxcbiAgICAobSkgPT4gc2V0VHJhbnNhY3Rpb25NZXNzYWdlRmVlUGF5ZXIoZmVlUGF5ZXIsIG0pLFxuICAgIChtKSA9PiBpbnN0cnVjdGlvbnMucmVkdWNlKFxuICAgICAgKGFjYywgaW5zdHJ1Y3Rpb24pID0+IGFwcGVuZFRyYW5zYWN0aW9uTWVzc2FnZUluc3RydWN0aW9uKGluc3RydWN0aW9uLCBhY2MpLFxuICAgICAgbVxuICAgICksXG4gICAgKG0pID0+IFwiYmxvY2toYXNoXCIgaW4gbGlmZXRpbWVDb25zdHJhaW50ID8gc2V0VHJhbnNhY3Rpb25NZXNzYWdlTGlmZXRpbWVVc2luZ0Jsb2NraGFzaChsaWZldGltZUNvbnN0cmFpbnQsIG0pIDogc2V0VHJhbnNhY3Rpb25NZXNzYWdlTGlmZXRpbWVVc2luZ0R1cmFibGVOb25jZShsaWZldGltZUNvbnN0cmFpbnQsIG0pXG4gICk7XG59XG5cbmV4cG9ydCB7IGFwcGVuZFRyYW5zYWN0aW9uTWVzc2FnZUluc3RydWN0aW9uLCBhcHBlbmRUcmFuc2FjdGlvbk1lc3NhZ2VJbnN0cnVjdGlvbnMsIGFzc2VydElzVHJhbnNhY3Rpb25NZXNzYWdlV2l0aEJsb2NraGFzaExpZmV0aW1lLCBhc3NlcnRJc1RyYW5zYWN0aW9uTWVzc2FnZVdpdGhEdXJhYmxlTm9uY2VMaWZldGltZSwgY29tcGlsZVRyYW5zYWN0aW9uTWVzc2FnZSwgY29tcHJlc3NUcmFuc2FjdGlvbk1lc3NhZ2VVc2luZ0FkZHJlc3NMb29rdXBUYWJsZXMsIGNyZWF0ZVRyYW5zYWN0aW9uTWVzc2FnZSwgZGVjb21waWxlVHJhbnNhY3Rpb25NZXNzYWdlLCBnZXRDb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZUNvZGVjLCBnZXRDb21waWxlZFRyYW5zYWN0aW9uTWVzc2FnZURlY29kZXIsIGdldENvbXBpbGVkVHJhbnNhY3Rpb25NZXNzYWdlRW5jb2RlciwgZ2V0VHJhbnNhY3Rpb25WZXJzaW9uQ29kZWMsIGdldFRyYW5zYWN0aW9uVmVyc2lvbkRlY29kZXIsIGdldFRyYW5zYWN0aW9uVmVyc2lvbkVuY29kZXIsIGlzQWR2YW5jZU5vbmNlQWNjb3VudEluc3RydWN0aW9uLCBpc1RyYW5zYWN0aW9uTWVzc2FnZVdpdGhCbG9ja2hhc2hMaWZldGltZSwgaXNUcmFuc2FjdGlvbk1lc3NhZ2VXaXRoRHVyYWJsZU5vbmNlTGlmZXRpbWUsIHByZXBlbmRUcmFuc2FjdGlvbk1lc3NhZ2VJbnN0cnVjdGlvbiwgcHJlcGVuZFRyYW5zYWN0aW9uTWVzc2FnZUluc3RydWN0aW9ucywgc2V0VHJhbnNhY3Rpb25NZXNzYWdlRmVlUGF5ZXIsIHNldFRyYW5zYWN0aW9uTWVzc2FnZUxpZmV0aW1lVXNpbmdCbG9ja2hhc2gsIHNldFRyYW5zYWN0aW9uTWVzc2FnZUxpZmV0aW1lVXNpbmdEdXJhYmxlTm9uY2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm5vZGUubWpzLm1hcFxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubm9kZS5tanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@solana+transaction-messages@3.0.3_fastestsmallesttextencoderdecoder@1.0.22_typescript@5.9.2/node_modules/@solana/transaction-messages/dist/index.node.mjs\n");

/***/ })

};
;